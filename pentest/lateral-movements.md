# Lateral movements

## Collections

Uncategorized

* [maaaaz/impacket-examples-windows - The great impacket example scripts compiled for Windows](https://github.com/maaaaz/impacket-examples-windows)
  * [blog: Remote NTLM relaying through meterpreter on Windows port 445 - ntmlrelayx 可以跟 proxychains 一起用: 一边监听转发过来的端口，一边走socks5给受害者发请求](https://diablohorn.com/2018/08/25/remote-ntlm-relaying-through-meterpreter-on-windows-port-445/)
* [securifera/serviceFu - Automates credential skimming from service accounts in Windows Registry，远程注册表 + SC](https://github.com/securifera/serviceFu)

Active domain

* [ANSSI-FR/AD-control-paths - Active Directory Control Paths auditing and graphing tools](https://github.com/ANSSI-FR/AD-control-paths)
* [skorov/ridrelay - Enumerate usernames on a domain where you have no creds by using SMB Relay with low priv](https://github.com/skorov/ridrelay)
* [NetSPI/goddi - goddi (go dump domain info) dumps Active Directory domain information](https://github.com/NetSPI/goddi)
* [sid-500 编写的各种PowerShell脚本](https://sid-500.com/downloads/)
* [k8gege/k8getPC - Using SMB/Browser Get Lan PC Name & OSversion](https://github.com/k8gege/k8getPC)
* [sensepost/UserEnum - Domain user enumeration tool](https://github.com/sensepost/UserEnum)
* [dev-2null/ADCollector - A lightweight tool to quickly extract valuable information from the Active Directory environment for both attacking and defending](https://github.com/dev-2null/ADCollector)
* [phillips321/adaudit - Powershell script to do domain auditing automation](https://github.com/phillips321/adaudit)
* [sense-of-security/ADRecon - a tool which gathers information about the Active Directory and generates a report which can provide a holistic picture of the current state of the target AD environment](https://github.com/sense-of-security/ADRecon)
* [NetSPI/goddi - go dump domain info - dumps Active Directory domain information](https://github.com/NetSPI/goddi)
* [sixdub/DomainTrustExplorer - Python script for analyis of the "Trust.csv" file generated by Veil PowerView. Provides graph based analysis and output - 结合 Invoke-MapDomainTrusts 一起使用](https://github.com/sixdub/DomainTrustExplorer)
* [DanMcInerney/icebreaker - Gets plaintext Active Directory credentials if you're on the internal network but outside the AD environment](https://github.com/DanMcInerney/icebreaker)
* [Tylous/Vibe - A framework for stealthy domain reconnaissance](https://github.com/Tylous/Vibe)
* [skorov/ridrelay - Enumerate usernames on a domain where you have no creds by using SMB Relay with low priv - 钓鱼成功会自动通过SMB查询账号](https://github.com/skorov/ridrelay)
* [Greenwolf/ntlm_theft - A tool for generating multiple types of NTLMv2 hash theft files by Jacob Wilkin (Greenwolf)](https://github.com/Greenwolf/ntlm_theft)
* [matthastings/DSCompromised - PowerShell framework for managing and infecting systems via Windows Desired State Configuration (DSC) - 需要Windows 2012以上系统](https://github.com/matthastings/DSCompromised)
* [leoloobeek/LAPSToolkit - Tool to audit and attack LAPS environments](https://github.com/leoloobeek/LAPSToolkit)
* [vletoux/MakeMeEnterpriseAdmin - 用金钥匙可以把 Domain Admins 提权到 Enterprise Admins，这个对mimikatz没有依赖](https://github.com/vletoux/MakeMeEnterpriseAdmin)
* [samratashok/ADModule - Microsoft signed ActiveDirectory PowerShell module (windows 2016里面复制出来的，有签名，可以绕过CLM限制)](https://github.com/samratashok/ADModule)
* [lazywinadmin/AdsiPS - PowerShell module to interact with Active Directory using ADSI and the System.DirectoryServices namespace (.NET Framework)](https://github.com/lazywinadmin/AdsiPS)
* [russelltomkins/Active-Directory - Collection of scripts for Querying and Managing Active Directory and Domain Controllers - 包含一些账号查询脚本，比如密码不过期的、开启了kerberos delegation的账号](https://github.com/russelltomkins/Active-Directory)
* [SecureThisShit/WinPwn - Automation for internal Windows Penetrationtest / AD-Security - Still much work to do](https://github.com/SecureThisShit/WinPwn)
* [aas-n/spraykatz - A tool to spray love around the world](https://github.com/aas-n/spraykatz)
* [davidprowe/BadBlood - fills a Microsoft Active Directory Domain with a structure and thousands of objects](https://github.com/davidprowe/BadBlood)
* [machosec/Mystique - PowerShell module to play with Kerberos S4U extensions](https://github.com/machosec/Mystique)
* Relay
  * [leechristensen/SpoolSample - PoC tool to coerce Windows hosts authenticate to other machines via the MS-RPRN RPC interface](https://github.com/leechristensen/SpoolSample)
    * [Hunting in Active Directory: Unconstrained Delegation & Forests Trusts - 这有个打印机的说明](https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1)
  * [Arno0x/NtlmRelayToEWS - ntlm relay attack to Exchange Web Services](https://github.com/Arno0x/NtlmRelayToEWS)
* NTLM
  * [vletoux/NTLMInjector - In case you didn't now how to restore the user password after a password reset (get the previous hash with DCSync) - 直接设置NTLM密码，用于恢复现场的](https://github.com/vletoux/NTLMInjector)
  * [eladshamir/Internal-Monologue - Internal Monologue Attack: Retrieving NTLM Hashes without Touching LSASS](https://github.com/eladshamir/Internal-Monologue)
* Mimikatz
  * [skelsec/pypykatz - Mimikatz implementation in pure Python](https://github.com/skelsec/pypykatz)
  * [Flangvik/BetterSafetyKatz - modified fork of SafetyKatz dynamically fetches the latest pre-compiled release of Mimikatz directly from the gentilkiwi GitHub repo, runtime patching on detected signatures and uses @subtee's PE Loader to get it into memory](https://github.com/Flangvik/BetterSafetyKatz)
* ADIDNS
  * [Kevin-Robertson/Powermad - PowerShell MachineAccountQuota and DNS exploit tools - AD-DNS工具、机器账号增删工具](https://github.com/Kevin-Robertson/Powermad)
    * [MachineAccountQuota is USEFUL Sometimes: Exploiting One of Active Directory’s Oddest Settings - 对于非DA账号，机器账号创建后无法删除；机器账号可以不带$，甚至以空格结尾](https://blog.netspi.com/machineaccountquota-is-useful-sometimes/)
  * [dirkjanm/adidnsdump - Active Directory Integrated DNS dumping by any authenticated user](https://github.com/dirkjanm/adidnsdump)
  * [b4rtik/SharpAdidnsdump - c# implementation of Active Directory Integrated DNS dumping (authenticated user)](https://github.com/b4rtik/SharpAdidnsdump)
  * [kurtfalde/DNS-Debug - Script to enabled DNS Debug Logging across Domain Controllers in a Forest and then retrieve for analysis](https://github.com/kurtfalde/DNS-Debug)

GPO

* [whitel1st/GP_Hijack - Group Policy Hijacking](https://github.com/whitel1st/GP_Hijack)
* [mwrlabs/SharpGPOAbuse - take advantage of a user's edit rights on a Group Policy Object (GPO) in order to compromise the objects that are controlled by that GPO](https://github.com/mwrlabs/SharpGPOAbuse)
* [l0ss/Grouper - A PowerShell script for helping to find vulnerable settings in AD Group Policy - 很有用的离线组策略分析工具，列出定时任务、MSI下发、防火墙设置等等](https://github.com/l0ss/Grouper)
  * [Get-GPTrashFire - 介绍功能的PPT](https://github.com/l0ss/Get-GPTrashfire/blob/master/Get-GPTrashFire.pdf)

WMI / WinRM

* [mez-0/CSharpWinRM - .NET 4.0 WinRM API Command Execution](https://github.com/mez-0/CSharpWinRM)
* [0xthirteen/SharpMove - 这个更全面一些，DCOM/WMI执行vbs/远程计划任务/远程修改现有服务/远程注册表改COM](https://github.com/0xthirteen/SharpMove)
* [Hackplayers/evil-winrm - The ultimate WinRM shell for hacking/pentesting](https://github.com/Hackplayers/evil-winrm)
* [Cybereason/Invoke-WMILM - a PoC script for various methods to acheive authenticated remote code execution via WMI, without (at least directly) using the Win32_Process class](https://github.com/Cybereason/Invoke-WMILM)
* [xorrior/RemoteRecon - provides the ability to execute post-exploitation capabilities against a remote host, without having to expose your complete toolkit/agent - 2017停更，用的 DotNetToJscript + WMI](https://github.com/xorrior/RemoteRecon)
* [hitb2018ams: No Win32_Process Needed - 就讲了一个WMI class继承，绕过检测的思路](https://conference.hitb.org/hitbsecconf2018ams/materials/D2T1%20-%20Philip%20Tsukerman%20-%20Expanding%20Your%20WMI%20Lateral%20Movement%20Arsenal.pdf)
* [checkymander/Sharp-InvokeWMIExec - A native C# conversion of Kevin Robertsons Invoke-WMIExec powershell script.](https://github.com/checkymander/Sharp-InvokeWMIExec/)
* [packer-community/winrmcp - Copy files to a remote host using WinRM](https://github.com/packer-community/winrmcp)
* [FortyNorthSecurity/WMIOps - a powershell script which uses WMI for various purposes across a network](https://github.com/FortyNorthSecurity/WMIOps)
* [QAX-A-Team/sharpwmi - sharpwmi是一个基于rpc的横向移动工具，具有上传文件和执行命令功能 - 包含 WMI StdRegProv csharp 调用例子](https://github.com/QAX-A-Team/sharpwmi)
* [rchaganti/CimUtils - Set of CIM utilities that can be used to make it easy to work with CIM classes](https://github.com/rchaganti/CimUtils)
* [FortyNorthSecurity/WMImplant - a PowerShell based tool that is designed to act like a RAT](https://github.com/FortyNorthSecurity/WMImplant)

LDAP

* [ropnop/windapsearch - Python script to enumerate users, groups and computers from a Windows domain through LDAP queries](https://github.com/ropnop/windapsearch)
* [shellster/LDAPPER - AD LDAP Command Line Searching that doesn't suck](https://github.com/shellster/LDAPPER)
* [stufus/ADOffline - Imports an LDAP file from Active Directory for SQL based offline reconnisance](https://github.com/stufus/ADOffline)

SMB

* [anthemtotheego/SharpExec - PSExec/WMIExec 实现](https://github.com/anthemtotheego/SharpExec)
* [portcullislabs/enum4linux - a Linux alternative to enum.exe for enumerating data from Windows and Samba hosts - 需要开启NULL Session才能利用，用处不大了](https://github.com/portcullislabs/enum4linux)
* [ShawnDEvans/smbmap - SMBMap is a handy SMB enumeration tool - 不要测试域控，sysvol默认可写不可删除](https://github.com/ShawnDEvans/smbmap)
* [kavika13/RemCom - Remote Command Executor: A OSS replacement for PsExec and RunAs - or Telnet without having to install a server](https://github.com/kavika13/RemCom)
* [shirosaidev/sharesniffer - Network share sniffer and auto-mounter for crawling remote file systems](https://github.com/shirosaidev/sharesniffer)
* [Mr-Un1k0d3r/SCShell - 使用 LogonUser + ChangeServiceConfigA 远程修改服务，并执行命令](https://github.com/Mr-Un1k0d3r/SCShell)
* [poweradminllc/PAExec - Remote execution, like PsExec - 2017停更](https://github.com/poweradminllc/PAExec)

DCOM

* [https://github.com/ScorpionesLabs/DVS - D(COM) V(ulnerability) S(canner) AKA Devious swiss army knife - Lateral movement using DCOM Objects](https://github.com/ScorpionesLabs/DVS)
* [codewhitesec/LethalHTA - Lateral Movement technique using DCOM and HTA](https://github.com/codewhitesec/LethalHTA)
* [hausec/COMMethodSearcher - Script that searches through all COM objects for any methods containing a key word of your choosing](https://github.com/hausec/COMMethodSearcher)
* [sud0woodo/DCOMrade - Powershell script for enumerating vulnerable DCOM Applications](https://github.com/sud0woodo/DCOMrade)
* [outflanknl/Excel4-DCOM - PowerShell and Cobalt Strike scripts for lateral movement using Excel 4.0 / XLM macros via DCOM (direct shellcode injection in Excel.exe)](https://github.com/outflanknl/Excel4-DCOM)
  * [rvrsh3ll/SharpExcel4-DCOM - Port of Invoke-Excel4DCOM](https://github.com/rvrsh3ll/SharpExcel4-DCOM)

Kerberos

* [Zer1t0/ticket_converter - A little tool to convert ccache tickets into kirbi (KRB-CRED) and vice versa based on impacket](https://github.com/Zer1t0/ticket_converter)
* [tothi/rbcd-attack - Kerberos Resource-Based Constrained Delegation Attack from Outside using Impacket - 这个是在有写权限的情况下，直接开启 delegation 并执行 S4U](https://github.com/tothi/rbcd-attack)
* [pkb1s/SharpAllowedToAct - Computer object takeover through Resource-Based Constrained Delegation (msDS-AllowedToActOnBehalfOfOtherIdentity)](https://github.com/pkb1s/SharpAllowedToAct)
* [Ridter/SharpAddDomainMachine - The same script as SharpAllowedToAct, but more usefully for local privilege escalation](https://github.com/Ridter/SharpAddDomainMachine)
* [the-useless-one/pywerview - A (partial) Python rewriting of PowerSploit's PowerView](https://github.com/the-useless-one/pywerview)
* [tevora-threat/SharpView - C# implementation of harmj0y's PowerView](https://github.com/tevora-threat/SharpView)
* [nidem/kerberoast - 这个是纯手动利用方案，只保留做参考](https://github.com/nidem/kerberoast)
  * [EmpireProject/Empire - data/module_source/credentials/Invoke-Kerberoast.ps1 - harmj0y 实现的，已经被 Rubeus 取代](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1)
* [skelsec/kerberoast - Kerberoast attack -pure python-](https://github.com/skelsec/kerberoast)
* [GhostPack/Rubeus - Trying to tame the three-headed dog](https://github.com/GhostPack/Rubeus/)
* [cyberark/RiskySPN - Detect and abuse risky SPNs](https://github.com/cyberark/RiskySPN)
* [ccache2john.py - ccache也可以爆破](https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/ccache2john.py)
* [ropnop/kerbrute - A tool to perform Kerberos pre-auth bruteforcing - AD默认不记录4771失败日志，而且这个爆破更快](https://github.com/ropnop/kerbrute)
* [dirkjanm/krbrelayx - Kerberos unconstrained delegation abuse toolkit](https://github.com/dirkjanm/krbrelayx)
* [3gstudent/pyKerbrute - Use python to perform Kerberos pre-auth bruteforcing](https://github.com/3gstudent/pyKerbrute)
* [redsiege.com: Kerberos & Attacks 101](https://www.redsiege.com/wp-content/uploads/2020/04/20200430-kerb101.pdf)

PTH
 
* [byt3bl33d3r/pth-toolkit - Modified version of the passing-the-hash tool collection (https://code.google.com/p/passing-the-hash/) made to work straight out of the box](https://github.com/byt3bl33d3r/pth-toolkit)
* [Kevin-Robertson/Invoke-TheHash - PowerShell Pass The Hash Utils](https://github.com/Kevin-Robertson/Invoke-TheHash)
* [mkellerman/Invoke-CommandAs - Invoke Command as System/User on Local/Remote computer using ScheduleTask](https://github.com/mkellerman/Invoke-CommandAs)

Printer

* [vletoux/SpoolerScanner - Check if MS-RPRN is remotely available with powershell/c#](https://github.com/vletoux/SpoolerScanner)
* [BusesCanFly/PRETty - "PRinter Exploitation Toolkit" LAN automation tool](https://github.com/BusesCanFly/PRETty)

## Tutorials

* [Lateral Movement - Windows and Active Directory](https://riccardoancarani.github.io/2019-10-04-lateral-movement-megaprimer/)

