# Lateral movements

## Collections

Uncategorized

* [maaaaz/impacket-examples-windows - The great impacket example scripts compiled for Windows](https://github.com/maaaaz/impacket-examples-windows)
  * [blog: Remote NTLM relaying through meterpreter on Windows port 445 - ntmlrelayx 可以跟 proxychains 一起用: 一边监听转发过来的端口，一边走socks5给受害者发请求](https://diablohorn.com/2018/08/25/remote-ntlm-relaying-through-meterpreter-on-windows-port-445/)
* [securifera/serviceFu - Automates credential skimming from service accounts in Windows Registry，远程注册表 + SC](https://github.com/securifera/serviceFu)
* [leechristensen/SpoolSample - PoC tool to coerce Windows hosts authenticate to other machines via the MS-RPRN RPC interface - 看不懂，也不容易测试](https://github.com/leechristensen/SpoolSample)

Active domain

* [dirkjanm/adidnsdump - Active Directory Integrated DNS dumping by any authenticated user](https://github.com/dirkjanm/adidnsdump)
* [b4rtik/SharpAdidnsdump - c# implementation of Active Directory Integrated DNS dumping (authenticated user)](https://github.com/b4rtik/SharpAdidnsdump)
* [l0ss/Grouper - A PowerShell script for helping to find vulnerable settings in AD Group Policy - 很有用的离线组策略分析工具，列出定时任务、MSI下发、防火墙设置等等](https://github.com/l0ss/Grouper)
  * [Get-GPTrashFire - 介绍功能的PPT](https://github.com/l0ss/Get-GPTrashfire/blob/master/Get-GPTrashFire.pdf)
* [sense-of-security/ADRecon - a tool which gathers information about the Active Directory and generates a report which can provide a holistic picture of the current state of the target AD environment](https://github.com/sense-of-security/ADRecon)
* [NetSPI/goddi - go dump domain info - dumps Active Directory domain information](https://github.com/NetSPI/goddi)
* [the-useless-one/pywerview - A (partial) Python rewriting of PowerSploit's PowerView](https://github.com/the-useless-one/pywerview)
* [sixdub/DomainTrustExplorer - Python script for analyis of the "Trust.csv" file generated by Veil PowerView. Provides graph based analysis and output - 结合 Invoke-MapDomainTrusts 一起使用](https://github.com/sixdub/DomainTrustExplorer)
* [DanMcInerney/icebreaker - Gets plaintext Active Directory credentials if you're on the internal network but outside the AD environment](https://github.com/DanMcInerney/icebreaker)
* [Tylous/Vibe - A framework for stealthy domain reconnaissance](https://github.com/Tylous/Vibe)
* [Arno0x/NtlmRelayToEWS - ntlm relay attack to Exchange Web Services](https://github.com/Arno0x/NtlmRelayToEWS)
* [skorov/ridrelay - Enumerate usernames on a domain where you have no creds by using SMB Relay with low priv - 钓鱼成功会自动通过SMB查询账号](https://github.com/skorov/ridrelay)
* [matthastings/DSCompromised - PowerShell framework for managing and infecting systems via Windows Desired State Configuration (DSC) - 需要Windows 2012以上系统](https://github.com/matthastings/DSCompromised)
* [Kevin-Robertson/Powermad - PowerShell MachineAccountQuota and DNS exploit tools](https://github.com/Kevin-Robertson/Powermad)
* [mwrlabs/SharpGPOAbuse - take advantage of a user's edit rights on a Group Policy Object (GPO) in order to compromise the objects that are controlled by that GPO](https://github.com/mwrlabs/SharpGPOAbuse)
* [leoloobeek/LAPSToolkit - Tool to audit and attack LAPS environments](https://github.com/leoloobeek/LAPSToolkit)
* [poweradminllc/PAExec - Remote execution, like PsExec - 2017停更](https://github.com/poweradminllc/PAExec)
* [vletoux/MakeMeEnterpriseAdmin - 用金钥匙可以把 Domain Admins 提权到 Enterprise Admins，这个对mimikatz没有依赖](https://github.com/vletoux/MakeMeEnterpriseAdmin)
* [samratashok/ADModule - Microsoft signed ActiveDirectory PowerShell module (windows 2016里面复制出来的，有签名，可以绕过CLM限制)](https://github.com/samratashok/ADModule)
* [lazywinadmin/AdsiPS - PowerShell module to interact with Active Directory using ADSI and the System.DirectoryServices namespace (.NET Framework)](https://github.com/lazywinadmin/AdsiPS)
* [russelltomkins/Active-Directory - Collection of scripts for Querying and Managing Active Directory and Domain Controllers - 包含一些账号查询脚本，比如密码不过期的、开启了kerberos delegation的账号](https://github.com/russelltomkins/Active-Directory)
* [SecureThisShit/WinPwn - Automation for internal Windows Penetrationtest / AD-Security - Still much work to do](https://github.com/SecureThisShit/WinPwn)
* [phillips321/adaudit - Powershell script to do domain auditing automation](https://github.com/phillips321/adaudit)
* NTLM
  * [vletoux/NTLMInjector - In case you didn't now how to restore the user password after a password reset (get the previous hash with DCSync) - 直接设置NTLM密码，用于恢复现场的](https://github.com/vletoux/NTLMInjector)
  * [eladshamir/Internal-Monologue - Internal Monologue Attack: Retrieving NTLM Hashes without Touching LSASS](https://github.com/eladshamir/Internal-Monologue)

WMI

* [Cybereason/Invoke-WMILM - a PoC script for various methods to acheive authenticated remote code execution via WMI, without (at least directly) using the Win32_Process class](https://github.com/Cybereason/Invoke-WMILM)
* [xorrior/RemoteRecon - provides the ability to execute post-exploitation capabilities against a remote host, without having to expose your complete toolkit/agent - 2017停更，用的 DotNetToJscript + WMI](https://github.com/xorrior/RemoteRecon)
* [Hackplayers/evil-winrm - The ultimate WinRM shell for hacking/pentesting](https://github.com/Hackplayers/evil-winrm)

LDAP

* [ropnop/windapsearch - Python script to enumerate users, groups and computers from a Windows domain through LDAP queries](https://github.com/ropnop/windapsearch)
* [shellster/LDAPPER - AD LDAP Command Line Searching that doesn't suck](https://github.com/shellster/LDAPPER)
* [stufus/ADOffline - Imports an LDAP file from Active Directory for SQL based offline reconnisance](https://github.com/stufus/ADOffline)

SMB

* [portcullislabs/enum4linux - a Linux alternative to enum.exe for enumerating data from Windows and Samba hosts - 需要开启NULL Session才能利用，用处不大了](https://github.com/portcullislabs/enum4linux)
* [ShawnDEvans/smbmap - SMBMap is a handy SMB enumeration tool - 不要测试域控，sysvol默认可写不可删除](https://github.com/ShawnDEvans/smbmap)
* [kavika13/RemCom - Remote Command Executor: A OSS replacement for PsExec and RunAs - or Telnet without having to install a server](https://github.com/kavika13/RemCom)
* [shirosaidev/sharesniffer - Network share sniffer and auto-mounter for crawling remote file systems](https://github.com/shirosaidev/sharesniffer)
* [Mr-Un1k0d3r/SCShell - 使用 LogonUser + ChangeServiceConfigA 远程修改服务，并执行命令](https://github.com/Mr-Un1k0d3r/SCShell)

DCOM

* [codewhitesec/LethalHTA - Lateral Movement technique using DCOM and HTA](https://github.com/codewhitesec/LethalHTA)
* [sud0woodo/DCOMrade - Powershell script for enumerating vulnerable DCOM Applications](https://github.com/sud0woodo/DCOMrade)
* [outflanknl/Excel4-DCOM - PowerShell and Cobalt Strike scripts for lateral movement using Excel 4.0 / XLM macros via DCOM (direct shellcode injection in Excel.exe)](https://github.com/outflanknl/Excel4-DCOM)
  * [rvrsh3ll/SharpExcel4-DCOM - Port of Invoke-Excel4DCOM](https://github.com/rvrsh3ll/SharpExcel4-DCOM)

WMI

* [checkymander/Sharp-InvokeWMIExec - A native C# conversion of Kevin Robertsons Invoke-WMIExec powershell script.](https://github.com/checkymander/Sharp-InvokeWMIExec/)
* [packer-community/winrmcp - Copy files to a remote host using WinRM](https://github.com/packer-community/winrmcp)
* [FortyNorthSecurity/WMIOps - a powershell script which uses WMI for various purposes across a network](https://github.com/FortyNorthSecurity/WMIOps)

Kerberos
* [GhostPack/Rubeus - Trying to tame the three-headed dog](https://github.com/GhostPack/Rubeus/)
* [cyberark/RiskySPN - Detect and abuse risky SPNs](https://github.com/cyberark/RiskySPN)
* [ccache2john.py - ccache也可以爆破](https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/ccache2john.py)
* [ropnop/kerbrute - A tool to perform Kerberos pre-auth bruteforcing - AD默认不记录4771失败日志](https://github.com/ropnop/kerbrute)
* [dirkjanm/krbrelayx - Kerberos unconstrained delegation abuse toolkit](https://github.com/dirkjanm/krbrelayx)

PTH
 
* [byt3bl33d3r/pth-toolkit - Modified version of the passing-the-hash tool collection (https://code.google.com/p/passing-the-hash/) made to work straight out of the box](https://github.com/byt3bl33d3r/pth-toolkit)
* [Kevin-Robertson/Invoke-TheHash - PowerShell Pass The Hash Utils](https://github.com/Kevin-Robertson/Invoke-TheHash)
* [mkellerman/Invoke-CommandAs - Invoke Command as System/User on Local/Remote computer using ScheduleTask](https://github.com/mkellerman/Invoke-CommandAs)

Printer

* [vletoux/SpoolerScanner - Check if MS-RPRN is remotely available with powershell/c#](https://github.com/vletoux/SpoolerScanner)
* [BusesCanFly/PRETty - "PRinter Exploitation Toolkit" LAN automation tool](https://github.com/BusesCanFly/PRETty)

