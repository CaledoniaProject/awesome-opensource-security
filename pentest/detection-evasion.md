# detection evasion

## Collections

Antivirus/EDR evasion

* [CylanceVulnResearch/ReflectiveDLLRefresher - a standalone test harness for scanning the process's memory space and unhooking the currently loaded libraries，恢复AV钩子的](https://github.com/CylanceVulnResearch/ReflectiveDLLRefresher)
* [secretsquirrel/SigThief - Stealing Signatures and Making One Invalid Signature at a Time](https://github.com/secretsquirrel/SigThief)
* [Shellter - AV Evasion Artware](https://www.shellterproject.com/)
* [Hackplayers/Salsa-tools - ShellReverse TCP/UDP/ICMP/DNS/SSL/BINDTCP and AV bypass, AMSI patched](https://github.com/Hackplayers/Salsa-tools)
* [Ch0pin/AVIator - Antivirus evasion project](https://github.com/Ch0pin/AVIator)
* [Mr-Un1k0d3r/DKMC - DKMC - Dont kill my cat - Malicious payload evasion tool](https://github.com/Mr-Un1k0d3r/DKMC)
* [Mr-Un1k0d3r/UniByAv - a simple obfuscator that take raw shellcode and generate executable that are Anti-Virus friendly](https://github.com/Mr-Un1k0d3r/UniByAv)
* [silentsignal/av-breaking - Bare Knuckled AV Breaking](https://github.com/silentsignal/av-breaking)
* [AbedAlqaderSwedan1/ASWCrypter - An Bash&Python Script For Generating Payloads that Bypasses All Antivirus so far FUD](https://github.com/AbedAlqaderSwedan1/ASWCrypter)
* [securemode/DefenderKeys - Quick PowerShell script to extract any exclusions configured for Windows Defender](https://github.com/securemode/DefenderKeys)
* [rootm0s/Protectors - Obfuscator, Encryption, Junkcode, Anti-Debug, PE protection/modification](https://github.com/rootm0s/Protectors)
* [threatexpress/metatwin - a file resource cloner. Metadata, including digital signature, is extracted from one file and injected into another](https://github.com/threatexpress/metatwin)
* [Ekultek/Graffiti - A tool to generate obfuscated one liners to aid in penetration testing](https://github.com/Ekultek/Graffiti)
* [DiabloHorn/cliramdisk - A reduced functionality cli client for the imdisk ram disk driver](https://github.com/DiabloHorn/cliramdisk)
* [gist: mattifestation/ExpandDefenderSig.ps1 - Decompresses Windows Defender AV signatures for exploration purposes](https://gist.github.com/mattifestation/3af5a472e11b7e135273e71cb5fed866)
* [perturbed-platypus - EDR Is Coming; Hide yo Sh!t - 将payload存储到UEFI](https://github.com/perturbed-platypus)
* [AdrianVollmer/PowerHub - A web application to transfer PowerShell modules, executables, snippets and files while bypassing AV and application whitelisting - 支持EXE/PS1远程加载](https://github.com/AdrianVollmer/PowerHub)

Restriction/whitelist bypass

* [gist: All System32 DLL export functions that contain "RunDLL", an indicator that it's designed to run with rundll32.exe](https://gist.github.com/mattifestation/27af49ff6b9ee6bbb21e4443310f70f5)
* [rvrsh3ll/CPLResourceRunner - Run shellcode from resource](https://github.com/rvrsh3ll/CPLResourceRunner)
* [fireeye/DueDLLigence - Shellcode runner for all application whitelisting bypasses](https://github.com/fireeye/DueDLLigence)
* [Neo23x0/DLLRunner - a smart DLL execution script for malware analysis in sandbox systems](https://github.com/Neo23x0/DLLRunner)
* Powershell
  * [p3nt4/PowerShdll - Run PowerShell with rundll32. Bypass software restrictions](https://github.com/p3nt4/PowerShdll)
  * [Ben0xA/nps - Not PowerShell](https://github.com/Ben0xA/nps)
  * [bitsadmin/nopowershell - PowerShell rebuilt in C# for Red Teaming purposes](https://github.com/bitsadmin/nopowershell)
  * [Cn33liz/CScriptShell - a Powershell Host running within cscript.exe](https://github.com/Cn33liz/CScriptShell)
  * [leechristensen/UnmanagedPowerShell - Executes PowerShell from an unmanaged process](https://github.com/leechristensen/UnmanagedPowerShell)
  * [Cn33liz/p0wnedLoader - 远程加载加密的 p0wnedShell，使用反射机制](https://github.com/Cn33liz/p0wnedLoader)
  * [mgeeky/Stracciatella - OpSec-safe Powershell runspace from within C# (aka SharpPick) with AMSI and Script Block Logging disabled](https://github.com/mgeeky/Stracciatella)
  * [OmerYa/Invisi-Shell - Hide your Powershell script in plain sight. Bypass all Powershell security features](https://github.com/OmerYa/Invisi-Shell)
  * [decoder-it/powershellveryless - Constrained Language Mode + AMSI bypass all in one](https://github.com/decoder-it/powershellveryless)
  * [PowerTools/PowerPick - Various ways of executing Powershell functionality without the use of Powershell](https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick)
* WMI
  * [0xbadjuju/WheresMyImplant - A Bring Your Own Land Toolkit that Doubles as a WMI Provider](https://github.com/0xbadjuju/WheresMyImplant)
* [SafeBreach-Labs/BACE - Mapping of Binaries that allows Arbitrary Code Execution](https://github.com/SafeBreach-Labs/BACE)
* [api0cradle/UltimateAppLockerByPassList - The goal of this repository is to document the most common techniques to bypass AppLocker](https://github.com/api0cradle/UltimateAppLockerByPassList)
* [GreatSCT/GreatSCT - an open source project to generate application white list bypasses](https://github.com/GreatSCT/GreatSCT)
* [infosecn1nja/MaliciousMacroMSBuild - Generates Malicious Macro and Execute Powershell or Shellcode via MSBuild Application Whitelisting Bypass](https://github.com/infosecn1nja/MaliciousMacroMSBuild)
* [api0cradle/LOLBAS - Living Off The Land Binaries And Scripts - (LOLBins and LOLScripts)](https://github.com/api0cradle/LOLBAS)
  * [LOLBAS-Project/LOLBAS](https://github.com/LOLBAS-Project/LOLBAS)
  * [Living Off The Land Binaries and Scripts (and also Libraries)](https://lolbas-project.github.io/)
* [rootm0s/WinPwnage - Elevate, UAC bypass, persistence, privilege escalation, dll hijack techniques](https://github.com/rootm0s/WinPwnage)

AMSI

* [didierstevens.com: New Tool: amsiscan.py](https://blog.didierstevens.com/2019/06/13/new-tool-amsiscan-py/)
* [spectorops: Antimalware Scan Interface Detection Optics Analysis Methodology: Identification and Analysis of AMSI for WMI - 通过amsi.dll关键词，枚举使用AMSI的EXE；通过ETW发现WinRM在产生 Microsoft-Antimalware-Scan-Interface 事件；逆向 JAmsiIsScannerNeeded 发现WMI有一套CRC白名单机制](https://posts.specterops.io/antimalware-scan-interface-detection-optics-analysis-methodology-858c37c38383)

Attack surface reduction

* [Bypass Windows Defender Attack Surface Reduction - 使用WMI、计划任务、COM、自定义PsExec服务名字实现绕过](https://github.com/sevagas/WindowsDefender_ASR_Bypass-OffensiveCon2019/blob/master/Bypass_Windows_Defender_ASR.pptx)

Signature identification

* [hegusung/AVSignSeek - Tool written in python3 to determine where the AV signature is located in a binary/payload](https://github.com/hegusung/AVSignSeek)
* [utds3lab/multiverse - A static binary rewriter that does not use heuristics](https://github.com/utds3lab/multiverse)
* [matterpreter/DefenderCheck - Identifies the bytes that Microsoft Defender flags on](https://github.com/matterpreter/DefenderCheck)

Linux

* [dsnezhkov/zombieant - A Kit For Playing Hide and Seek with Linux EDRs](https://github.com/dsnezhkov/zombieant/)
* [tokyoneon/Armor - Armor is a simple Bash script designed to create encrypted macOS payloads capable of evading antivirus scanners](https://github.com/tokyoneon/Armor)
* [Bashfuscator - A fully configurable and extendable Bash obfuscation framework](https://github.com/Bashfuscator/Bashfuscator)

CSharp

* [two06/Inception - Provides In-memory compilation and reflective loading of C# apps for AV evasion](https://github.com/two06/Inception)

VBScript/VBA

* [DoctorLai/VBScript_Obfuscator - The VBScript Obfuscator written in VBScript](https://github.com/DoctorLai/VBScript_Obfuscator)
* [mwrlabs/wePWNise - generates architecture independent VBA code to be used in Office documents or templates and automates bypassing application control and exploit mitigation software](https://github.com/mwrlabs/wePWNise)
* [itm4n/VBA-RunPE - A VBA implementation of the RunPE technique or how to bypass application whitelisting](https://github.com/itm4n/VBA-RunPE)

HTA

* [nccgroup/demiguise - HTA encryption tool](https://github.com/nccgroup/demiguise)

Traffic analysis evasion

* [rvrsh3ll/FindFrontableDomains - Search for potential frontable domains](https://github.com/rvrsh3ll/FindFrontableDomains)
* [redteam-cyberark/Google-Domain-fronting - Domain fronting using Google app engine](https://github.com/redteam-cyberark/Google-Domain-fronting)
* [vysec/DomainFrontingLists - A list of Domain Frontable Domains by CDN](https://github.com/vysec/DomainFrontingLists)
* [al0ne/Nmap_Bypass_IDS - nmap绕过IDS的各种技巧](https://github.com/al0ne/Nmap_Bypass_IDS)
* [kirillwow/ids_bypass - IDS Bypass tricks](https://github.com/kirillwow/ids_bypass)

Sandbox/cloud based detection evasion

* [violentlydave/mkhtaccess_red - Auto-generate an HTaccess for payload delivery -- automatically pulls ips/nets/etc from known sandbox companies/sources that have been seen before, and redirects them to a benign payload](https://github.com/violentlydave/mkhtaccess_red)
* [David-Reguera-Garcia-Dreg/anticuckoo - A tool to detect and crash Cuckoo Sandbox](https://github.com/David-Reguera-Garcia-Dreg/anticuckoo)
* [a0rtega/pafish - a demonstration tool that employs several techniques to detect sandboxes and analysis environments in the same way as malware families do](https://github.com/a0rtega/pafish)
* [LordNoteworthy/al-khaser - Public malware techniques used in the wild: Virtual Machine, Emulation, Debuggers, Sandbox detection](https://github.com/LordNoteworthy/al-khaser)
* [AlicanAkyol/sems - Virtualbox, VirtualMachine, Cuckoo, Anubis, ThreatExpert, Sandboxie, QEMU, Analysis Tools Detection Tools](https://github.com/AlicanAkyol/sems)
* [Arvanaghi/CheckPlease - Sandbox evasion modules written in PowerShell, Python, Go, Ruby, C, C#, Perl, and Rust](https://github.com/Arvanaghi/CheckPlease)
* [sharepub/CheckVM-Sandbox](https://github.com/sharepub/CheckVM-Sandbox)
* [hacksysteam/WpadEscape - Sandbox escape using WinHTTP Web Proxy Auto-Discovery Service](https://github.com/hacksysteam/WpadEscape)
* [fr0gger/RocProtect-V1 - Emulating Virtual Environment to stay protected against advanced malware](https://github.com/fr0gger/RocProtect-V1)

Steganography

* [Und3rf10w/boblobblob - hiding git blobs in plain sight](https://github.com/Und3rf10w/boblobblob)
* [peewpw/Invoke-PSImage - Embeds a PowerShell script in the pixels of a PNG file and generates a oneliner to execute](https://github.com/peewpw/Invoke-PSImage)






