# detection evasion

## Collections

Antivirus/EDR evasion

* [jthuraisamy/TelemetrySourcerer - Enumerate and disable common sources of telemetry used by AV/EDR - 用驱动删除AV的回调和钩子](https://github.com/jthuraisamy/TelemetrySourcerer)
* [br-sn/CheekyBlinder - Enumerating and removing kernel callbacks using signed vulnerable drivers](https://github.com/br-sn/CheekyBlinder)
* [ayoul3/reflect-pe - Reflectively load PE - 带一个关键词替换功能](https://github.com/ayoul3/reflect-pe)
* [scrt/avcleaner - C/C++ source obfuscator for antivirus bypass](https://github.com/scrt/avcleaner)
* [CylanceVulnResearch/ReflectiveDLLRefresher - a standalone test harness for scanning the process's memory space and unhooking the currently loaded libraries，恢复AV钩子的](https://github.com/CylanceVulnResearch/ReflectiveDLLRefresher)
* [secretsquirrel/SigThief - Stealing Signatures and Making One Invalid Signature at a Time](https://github.com/secretsquirrel/SigThief)
* [Shellter - AV Evasion Artware](https://www.shellterproject.com/)
* [Hackplayers/Salsa-tools - ShellReverse TCP/UDP/ICMP/DNS/SSL/BINDTCP and AV bypass, AMSI patched](https://github.com/Hackplayers/Salsa-tools)
* [Ch0pin/AVIator - Antivirus evasion project](https://github.com/Ch0pin/AVIator)
* [Mr-Un1k0d3r/DKMC - DKMC - Dont kill my cat - Malicious payload evasion tool](https://github.com/Mr-Un1k0d3r/DKMC)
* [Mr-Un1k0d3r/UniByAv - a simple obfuscator that take raw shellcode and generate executable that are Anti-Virus friendly](https://github.com/Mr-Un1k0d3r/UniByAv)
* [silentsignal/av-breaking - Bare Knuckled AV Breaking](https://github.com/silentsignal/av-breaking)
* [AbedAlqaderSwedan1/ASWCrypter - An Bash&Python Script For Generating Payloads that Bypasses All Antivirus so far FUD](https://github.com/AbedAlqaderSwedan1/ASWCrypter)
* [securemode/DefenderKeys - Quick PowerShell script to extract any exclusions configured for Windows Defender](https://github.com/securemode/DefenderKeys)
* [rootm0s/Protectors - Obfuscator, Encryption, Junkcode, Anti-Debug, PE protection/modification](https://github.com/rootm0s/Protectors)
* [threatexpress/metatwin - a file resource cloner. Metadata, including digital signature, is extracted from one file and injected into another](https://github.com/threatexpress/metatwin)
* [Ekultek/Graffiti - A tool to generate obfuscated one liners to aid in penetration testing](https://github.com/Ekultek/Graffiti)
* [DiabloHorn/cliramdisk - A reduced functionality cli client for the imdisk ram disk driver](https://github.com/DiabloHorn/cliramdisk)
* [gist: mattifestation/ExpandDefenderSig.ps1 - Decompresses Windows Defender AV signatures for exploration purposes](https://gist.github.com/mattifestation/3af5a472e11b7e135273e71cb5fed866)
* [perturbed-platypus - EDR Is Coming; Hide yo Sh!t - 将payload存储到UEFI](https://github.com/perturbed-platypus)
* [AdrianVollmer/PowerHub - A web application to transfer PowerShell modules, executables, snippets and files while bypassing AV and application whitelisting - 支持EXE/PS1远程加载](https://github.com/AdrianVollmer/PowerHub)
* [TideSec/BypassAntiVirus - 远控免杀系列文章及配套工具，搜集汇总了互联网上的几十种免杀工具和免杀方法 - 没啥用，只记录](https://github.com/TideSec/BypassAntiVirus)
* [the-xentropy/xencrypt - A PowerShell script anti-virus evasion tool](https://github.com/the-xentropy/xencrypt)
* [DeEpinGh0st/AutoRemove - 利用PyautoGUI实现的对防病毒软件的自动化卸载](https://github.com/DeEpinGh0st/AutoRemove)

Restriction/whitelist bypass

* [Mr-Un1k0d3r/Windows-SignedBinary - bypass endpoint solution that block known "malicious" signed application such as "regsvr32.exe" - 生成HASH不同，但是有微软签名的程序。方法是随机修改几个字节，检查签名是否还有效](https://github.com/Mr-Un1k0d3r/Windows-SignedBinary)
* [rootm0s/WinPwnage - Elevate, UAC bypass, persistence, privilege escalation, dll hijack techniques](https://github.com/rootm0s/WinPwnage)
* [SafeBreach-Labs/BACE - Mapping of Binaries that allows Arbitrary Code Execution](https://github.com/SafeBreach-Labs/BACE)
* [GreatSCT/GreatSCT - an open source project to generate application white list bypasses](https://github.com/GreatSCT/GreatSCT)
* [infosecn1nja/MaliciousMacroMSBuild - Generates Malicious Macro and Execute Powershell or Shellcode via MSBuild Application Whitelisting Bypass](https://github.com/infosecn1nja/MaliciousMacroMSBuild)
* [Jumbo-WJB/windows_exec_ways](https://github.com/Jumbo-WJB/windows_exec_ways)
* [gist: All System32 DLL export functions that contain "RunDLL", an indicator that it's designed to run with rundll32.exe](https://gist.github.com/mattifestation/27af49ff6b9ee6bbb21e4443310f70f5)
* [rvrsh3ll/CPLResourceRunner - Run shellcode from resource](https://github.com/rvrsh3ll/CPLResourceRunner)
* [fireeye/DueDLLigence - Shellcode runner for all application whitelisting bypasses](https://github.com/fireeye/DueDLLigence)
* [Neo23x0/DLLRunner - a smart DLL execution script for malware analysis in sandbox systems](https://github.com/Neo23x0/DLLRunner)
* [bohops/GhostBuild - a collection of simple MSBuild launchers for various GhostPack/.NET projects](https://github.com/bohops/GhostBuild)
* [outflanknl/NetshHelperBeacon - Example DLL to load from Windows NetShell - 没啥用](https://github.com/outflanknl/NetshHelperBeacon)
* [cyberark/Evasor - A tool to be used in post exploitation phase for blue and red teams to bypass APPLICATIONCONTROL policies](https://github.com/cyberark/Evasor)
* [trustedsec/auto_SettingContent-ms - a quick POC for using the Matt Nelson (enigma0x3) technique for generating a malicious .SettingContent-ms extension type for remote code execution - 执行方法与HTA一致](https://github.com/trustedsec/auto_SettingContent-ms)
* [jpginc/xbapAppWhitelistBypassPOC - A POC application whitelisting XBAP project](https://github.com/jpginc/xbapAppWhitelistBypassPOC)
* Powershell
  * [p3nt4/PowerShdll - Run PowerShell with rundll32. Bypass software restrictions](https://github.com/p3nt4/PowerShdll)
  * [Ben0xA/nps - Not PowerShell](https://github.com/Ben0xA/nps)
  * [bitsadmin/nopowershell - PowerShell rebuilt in C# for Red Teaming purposes](https://github.com/bitsadmin/nopowershell)
  * [Cn33liz/CScriptShell - a Powershell Host running within cscript.exe](https://github.com/Cn33liz/CScriptShell)
  * [leechristensen/UnmanagedPowerShell - Executes PowerShell from an unmanaged process](https://github.com/leechristensen/UnmanagedPowerShell)
  * [Cn33liz/p0wnedLoader - 远程加载加密的 p0wnedShell，使用反射机制](https://github.com/Cn33liz/p0wnedLoader)
  * [mgeeky/Stracciatella - OpSec-safe Powershell runspace from within C# (aka SharpPick) with AMSI and Script Block Logging disabled](https://github.com/mgeeky/Stracciatella)
  * [OmerYa/Invisi-Shell - Hide your Powershell script in plain sight. Bypass all Powershell security features](https://github.com/OmerYa/Invisi-Shell)
  * [decoder-it/powershellveryless - Constrained Language Mode + AMSI bypass all in one](https://github.com/decoder-it/powershellveryless)
  * [PowerTools/PowerPick - Various ways of executing Powershell functionality without the use of Powershell](https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick)
  * [Mr-Un1k0d3r/PowerLessShell - Run PowerShell command without invoking powershell.exe](https://github.com/Mr-Un1k0d3r/PowerLessShell)
* WMI
  * [0xbadjuju/WheresMyImplant - A Bring Your Own Land Toolkit that Doubles as a WMI Provider](https://github.com/0xbadjuju/WheresMyImplant)
* Applocker
  * [api0cradle/UltimateAppLockerByPassList - The goal of this repository is to document the most common techniques to bypass AppLocker](https://github.com/api0cradle/UltimateAppLockerByPassList)
  * [freshness79/unlock - Microsoft Applocker evasion tool](https://github.com/freshness79/unlock)
  * [cyberark/Evasor - an automated security assessment tool which locates existing executables on the Windows operating system that can be used to bypass any Application Control rules](https://github.com/cyberark/Evasor)
* [api0cradle/LOLBAS - Living Off The Land Binaries And Scripts - (LOLBins and LOLScripts)](https://github.com/api0cradle/LOLBAS)
  * [LOLBAS-Project/LOLBAS](https://github.com/LOLBAS-Project/LOLBAS)
  * [Living Off The Land Binaries and Scripts (and also Libraries)](https://lolbas-project.github.io/)

AMSI

* [didierstevens.com: New Tool: amsiscan.py](https://blog.didierstevens.com/2019/06/13/new-tool-amsiscan-py/)
* [spectorops: Antimalware Scan Interface Detection Optics Analysis Methodology: Identification and Analysis of AMSI for WMI - 通过amsi.dll关键词，枚举使用AMSI的EXE；通过ETW发现WinRM在产生 Microsoft-Antimalware-Scan-Interface 事件；逆向 JAmsiIsScannerNeeded 发现WMI有一套CRC白名单机制](https://posts.specterops.io/antimalware-scan-interface-detection-optics-analysis-methodology-858c37c38383)
* [RythmStick/AMSITrigger - The Hunt for Malicious Strings - pinvoke 调用 AmsiScanBuffer，定位特征码](https://github.com/RythmStick/AMSITrigger)
* [atxsinn3r/amsiscanner - A C/C++ implementation of Microsoft's Antimalware Scan Interface](https://github.com/atxsinn3r/amsiscanner)

Attack surface reduction - ASR

* [Bypass Windows Defender Attack Surface Reduction - 使用WMI、计划任务、COM、自定义PsExec服务名字实现绕过](https://github.com/sevagas/WindowsDefender_ASR_Bypass-OffensiveCon2019/blob/master/Bypass_Windows_Defender_ASR.pptx)

Signature identification

* [hegusung/AVSignSeek - Tool written in python3 to determine where the AV signature is located in a binary/payload](https://github.com/hegusung/AVSignSeek)
* [utds3lab/multiverse - A static binary rewriter that does not use heuristics](https://github.com/utds3lab/multiverse)
* [matterpreter/DefenderCheck - Identifies the bytes that Microsoft Defender flags on - 特征码识别](https://github.com/matterpreter/DefenderCheck)

Linux

* [tokyoneon/Armor - Armor is a simple Bash script designed to create encrypted macOS payloads capable of evading antivirus scanners](https://github.com/tokyoneon/Armor)
* [Bashfuscator - A fully configurable and extendable Bash obfuscation framework](https://github.com/Bashfuscator/Bashfuscator)

VBScript/VBA

* [DoctorLai/VBScript_Obfuscator - The VBScript Obfuscator written in VBScript](https://github.com/DoctorLai/VBScript_Obfuscator)
* [mwrlabs/wePWNise - generates architecture independent VBA code to be used in Office documents or templates and automates bypassing application control and exploit mitigation software](https://github.com/mwrlabs/wePWNise)
* [itm4n/VBA-RunPE - A VBA implementation of the RunPE technique or how to bypass application whitelisting](https://github.com/itm4n/VBA-RunPE)

HTA

* [nccgroup/demiguise - HTA encryption tool](https://github.com/nccgroup/demiguise)

Traffic analysis evasion

* [rvrsh3ll/FindFrontableDomains - Search for potential frontable domains](https://github.com/rvrsh3ll/FindFrontableDomains)
* [redteam-cyberark/Google-Domain-fronting - Domain fronting using Google app engine](https://github.com/redteam-cyberark/Google-Domain-fronting)
* [vysec/DomainFrontingLists - A list of Domain Frontable Domains by CDN](https://github.com/vysec/DomainFrontingLists)
* [al0ne/Nmap_Bypass_IDS - nmap绕过IDS的各种技巧](https://github.com/al0ne/Nmap_Bypass_IDS)
* [kirillwow/ids_bypass - IDS Bypass tricks](https://github.com/kirillwow/ids_bypass)

Sandbox/cloud based detection evasion

* [violentlydave/mkhtaccess_red - Auto-generate an HTaccess for payload delivery -- automatically pulls ips/nets/etc from known sandbox companies/sources that have been seen before, and redirects them to a benign payload](https://github.com/violentlydave/mkhtaccess_red)
* [David-Reguera-Garcia-Dreg/anticuckoo - A tool to detect and crash Cuckoo Sandbox](https://github.com/David-Reguera-Garcia-Dreg/anticuckoo)
* [a0rtega/pafish - a demonstration tool that employs several techniques to detect sandboxes and analysis environments in the same way as malware families do](https://github.com/a0rtega/pafish)
* [LordNoteworthy/al-khaser - Public malware techniques used in the wild: Virtual Machine, Emulation, Debuggers, Sandbox detection](https://github.com/LordNoteworthy/al-khaser)
* [AlicanAkyol/sems - Virtualbox, VirtualMachine, Cuckoo, Anubis, ThreatExpert, Sandboxie, QEMU, Analysis Tools Detection Tools](https://github.com/AlicanAkyol/sems)
* [Arvanaghi/CheckPlease - Sandbox evasion modules written in PowerShell, Python, Go, Ruby, C, C#, Perl, and Rust](https://github.com/Arvanaghi/CheckPlease)
* [sharepub/CheckVM-Sandbox](https://github.com/sharepub/CheckVM-Sandbox)
* [fr0gger/RocProtect-V1 - Emulating Virtual Environment to stay protected against advanced malware](https://github.com/fr0gger/RocProtect-V1)
* [G4lB1t/SmoothCriminal - Detect sandbox by cursor movement speed - cuckoo的鼠标模拟是固定的，不够随机](https://github.com/G4lB1t/SmoothCriminal)
* [CheckPointSW/InviZzzible - a tool for assessment of your virtual environments in an easy and reliable way. It contains the most recent and up to date detection and evasion techniques as well as fixes for them](https://github.com/CheckPointSW/InviZzzible)
* [ZanderChang/anti-sandbox - Windows对抗沙箱和虚拟机的方法总结](https://github.com/ZanderChang/anti-sandbox)
* 常见思路 - 如果读取注册表、检查沙箱、执行 ping 实现延迟、GetTickCount，会被杀软标记为可疑行为
  * 检查文件名长度是否为32或者包含`.md5.exe`
  * 桌面上的图标数量
  * 使用 GetForegroundWindow + Sleep 检查用户是否切换过窗口且数量大于3
  * 若 `py saz pcap chls` 之一存在文件关联，判断为沙箱环境
  * 使用 GetMonitorInfoA 检查分辨率是否高于 800x600（360有物理机无效）
  * [Summary of recent Anti-Sandbox Tricks - 检查声卡 DirectShow 的案例](http://blog.joesecurity.org/2016/06/summary-of-recent-anti-sandbox-tricks.html)
  * [Analyzing Azorult's Anti-Analysis Tricks with Joe Sandbox Hypervisor - 这个是规则检测](https://www.joesecurity.org/blog/9048980422564630717)

Steganography 隐写术

* [Und3rf10w/boblobblob - hiding git blobs in plain sight](https://github.com/Und3rf10w/boblobblob)
* [peewpw/Invoke-PSImage - Embeds a PowerShell script in the pixels of a PNG file and generates a oneliner to execute](https://github.com/peewpw/Invoke-PSImage)
* [DominicBreuker/stego-toolkit - Collection of steganography tools - helps with CTF challenges](https://github.com/DominicBreuker/stego-toolkit)
* [Under the hood: Hiding data in JPEG images](https://blog.nviso.eu/2020/07/13/how-to-embed-secret-data-in-jpeg-files/)

Uncategorized

* [OsandaMalith/PE2HTML - Injects HTML/PHP/ASP to the PE](https://github.com/OsandaMalith/PE2HTML)

## Resources

* [Unprotect Project](https://search.unprotect.it/map)
* [Anti-Virus, No Thanks - Mark Baggett - 很老的免杀技术了，仅供参考](https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1493863710.pdf)
* [Bypass Windows Defender Attack Surface Reduction - 2019年的，未测试 - ASR目前不拦截计划任务、自定义COM组件；使用 type 命令重写文件绕过 Zone Identifier；...](https://blog.sevagas.com/IMG/pdf/bypass_windows_defender_attack_surface_reduction.pdf)
* [xcon2016: 用深入解析AV虚拟机&高级Bypass技术](http://www.vxjump.net/files/seccon/BAVE_xcon2016.pdf)
* [A Guide to Reversing and Evading EDRs: Part 1](http://jackson-t.ca/edr-reversing-evading-01.html)


