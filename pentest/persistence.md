# persistence

## Collections

Uncategorized

* [SECFORCE/Tunna - a set of tools which will wrap and tunnel any TCP communication over HTTP](https://github.com/SECFORCE/Tunna)
* [0x00-0x00/ShellPop - Pop shells like a master](https://github.com/0x00-0x00/ShellPop)
* [emptymonkey/mimic - a tool for covert execution on Linux x86_64](https://github.com/emptymonkey/mimic)
* [ulissescastro/linux-native-backdoors - Repository holding all alternatives of nix backdoors](https://github.com/ulissescastro/linux-native-backdoors)
* [TestingPens/MalwarePersistenceScripts - A collection of scripts I've written to help red and blue teams with malware persistence techniques](https://github.com/TestingPens/MalwarePersistenceScripts)
* [nettitude/PoshC2 - Powershell C2 Server and Implants](https://github.com/nettitude/PoshC2)
* [fireeye/SharPersist - Windows persistence toolkit written in C# - 都是常见方法，没卵用](https://github.com/fireeye/SharPersist)

WNF - Windows Notification Facilities

* [ustayready/CasperStager - PoC for persisting .NET payloads in Windows Notification Facility (WNF) state names using low-level Windows Kernel API calls](https://github.com/ustayready/CasperStager)
* [citronneur/volatility-wnf - Browse and dump Windows Notification Facilities](https://github.com/citronneur/volatility-wnf)
* [ionescu007/wnfun - WNF Utilities 4 Newbies (WNFUN)](https://github.com/ionescu007/wnfun)

PE backdooring

* [secretsquirrel/the-backdoor-factory - Patch PE, ELF, Mach-O binaries with shellcode (停止维护了)](https://github.com/secretsquirrel/the-backdoor-factory)
* [xan7r/cypher - Simple tool to automate adding shellcode to PE files](https://github.com/xan7r/cypher)
* [secretsquirrel/BDFProxy - Patch Binaries via MITM: BackdoorFactory + mitmProxy - 貌似停止更新了](https://github.com/secretsquirrel/BDFProxy)
* [JonDoNym/peinjector - peinjector - MITM PE file infector](https://github.com/JonDoNym/peinjector)
* [awgh/binjection - Injects additional machine instructions into various binary formats](https://github.com/awgh/binjection)
* Keepass
  * [medium: two06 - Persistence with KeePass - C# 插件方式上线](https://medium.com/@two06/persistence-with-keepass-part-1-d2e705326aa6)
* Dll hijack identification
  * [sensepost/rattler - Automated DLL Enumerator](https://github.com/sensepost/rattler)
  * [MojtabaTajik/Robber - Robber is open source tool for finding executables prone to DLL hijacking](https://github.com/MojtabaTajik/Robber)
  * [DinoBytes/dylib_hijack_scanner - Simple utility used to scan a directory for possibly dylib hijacks](https://github.com/DinoBytes/dylib_hijack_scanner)

WebShell - generic

* [GoSecure/php7-opcache-override - Security-related PHP7 OPcache abuse tools and demo - 不实用，容易影响人家业务](https://github.com/GoSecure/php7-opcache-override)
* [nil0x42/phpsploit - Stealth post-exploitation framework](https://github.com/nil0x42/phpsploit)
* [rebeyond/Behinder - “冰蝎”动态二进制加密网站管理客户端](https://github.com/rebeyond/Behinder)
  * [Skactor/behinder_source - 冰蝎的源码（Decompile & Fixed）](https://github.com/Skactor/behinder_source)
* [xl7dev/WebShell - Webshell && Backdoor Collection](https://github.com/xl7dev/WebShell)
* [webshellpub/awsome-webshell - webshell样本大合集。收集各种webshell用于webshell分析与发现](https://github.com/webshellpub/awsome-webshell)
* [yzddmr6/php_xor_bypass - 利用随机异或无限免杀d盾](https://github.com/yzddmr6/php_xor_bypass)
* [yzddmr6/webshell-venom - 免杀webshell无限生成工具](https://github.com/yzddmr6/webshell-venom)

WebShell - PHP

* [epinna/weevely3 - Weaponized web shell](https://github.com/epinna/weevely3)
* [Arrexel/phpbash - A semi-interactive PHP shell compressed into a single file](https://github.com/Arrexel/phpbash)
* [s0md3v/nano - Nano is a family of PHP web shells which are code golfed for stealth](https://github.com/s0md3v/nano)
* [Medicean/as_bypass_php_disable_functions - antsword 插件，突破 disable_functions 执行系统命令，绕过 open_basedir 等安全机制](https://github.com/Medicean/as_bypass_php_disable_functions)
* [flozz/p0wny-shell - Single-file PHP shell](https://github.com/flozz/p0wny-shell)
* [prsecurity/php_aes_shell_gen - Generate AES-256-CBC encrypted PHP shells](https://github.com/prsecurity/php_aes_shell_gen)
* [KCon 2019 - PHP动态特性的捕捉与逃逸 - 介绍了多种变形](https://github.com/knownsec/KCon/blob/master/2019/25%E6%97%A5/PHP%E5%8A%A8%E6%80%81%E7%89%B9%E6%80%A7%E7%9A%84%E6%8D%95%E6%8D%89%E4%B8%8E%E9%80%83%E9%80%B8.pdf)

WebShell - Java

* [rebeyond/memShell - javaagent ATTACH 机制后门](https://github.com/rebeyond/memShell)
* [nanolikeyou/jniwebshell - jni 后门](https://github.com/nanolikeyou/jniwebshell)

WebShell - .NET 

* [antonioCoco/SharPyShell - tiny and obfuscated ASP.NET webshell for C# web applications](https://github.com/antonioCoco/SharPyShell)
* [Ivan1ee/svcLessSpy - 探索基于.NET下实现一句话木马之SVC篇](https://github.com/Ivan1ee/svcLessSpy)
* [Ivan1ee/ashxLessSpy - 探索基于.NET下实现一句话木马之ashx篇](https://github.com/Ivan1ee/ashxLessSpy)
* [Ivan1ee/asmxLessSpy - 探索基于.NET下实现一句话木马之asmx篇](https://github.com/Ivan1ee/asmxLessSpy)
* [Ivan1ee/NetDLLSpy - 探索基于.NET下实现一句话木马之DLL篇](https://github.com/Ivan1ee/NetDLLSpy)

IIS/Apache/PHP modules

* [WBGlIl/IIS_backdoor - 主要是实现了3个功能执行cmd命令，C#调用powershell，执行shellcode](https://github.com/WBGlIl/IIS_backdoor)
* [WangYihang/Apache-HTTP-Server-Module-Backdoor - A Backdoor For Apache HTTP Server Written in C](https://github.com/WangYihang/Apache-HTTP-Server-Module-Backdoor)

Reverse shells

* [emptymonkey/revsh - A reverse shell with terminal support, data tunneling, and advanced pivoting capabilities](https://github.com/emptymonkey/revsh)
* [mthbernardes/rsg - A tool to generate various ways to do a reverse shell](https://github.com/mthbernardes/rsg)
* [blacknbunny/mcreator - Encoded Reverse Shell Generator With Techniques To Bypass AV's](https://github.com/blacknbunny/mcreator)
* [Hood3dRob1n/JSRat-Py - This is my implementation of JSRat.ps1 in Python so you can now run the attack server from any OS instead of being limited to a Windows OS with Powershell enabled](https://github.com/Hood3dRob1n/JSRat-Py)
* [lesnuages/hershell - Multiplatform reverse shell generator](https://github.com/lesnuages/hershell)
* [besimorhino/powercat - netshell features all in version 2 powershell - 没有stderr重定向，不能启动其他占用终端的程序](https://github.com/besimorhino/powercat)

RAT

* [yuanyuanxiang/SimpleRemoter - 基于gh0st的远程控制器：实现了终端管理、进程管理、窗口管理、远程桌面、文件管理、语音管理、视频管理、服务管理、注册表管理等功能，优化全部代码及整理排版，修复内存泄漏缺陷，程序运行稳定。](https://github.com/yuanyuanxiang/SimpleRemoter)
* [mimah/GoMet - Multi-platform agent written in Golang. TCP forwarding, socks5, tunneling, pivoting, shell, download, exec](https://github.com/mimah/GoMet)
* [byt3bl33d3r/SILENTTRINITY - A post-exploitation agent powered by Python, IronPython, C#/.NET - 内存加载方式，但是要求 .NET 4.5](https://github.com/byt3bl33d3r/SILENTTRINITY)
* [orangetw/tsh - an open-source UNIX backdoor](https://github.com/orangetw/tsh)
* [zerosum0x0/koadic - Koadic C3 COM Command & Control - JScript 远控，基于 dynwrapx 执行任意代码的](https://github.com/zerosum0x0/koadic)
* [TheM4hd1/Vayne-RaT - An Advanced C# .NET Rat](https://github.com/TheM4hd1/Vayne-RaT)
* [tiagorlampert/CHAOS - CHAOS allow generate payloads and control remote Windows systems](https://github.com/tiagorlampert/CHAOS)
* [colental/byob - BYOB (Build Your Own Botnet)](https://github.com/colental/byob)
* [Souhardya/Uboat - HTTP Botnet Project](https://github.com/Souhardya/Uboat)
* [audibleblink/gorsh - A Golang Implant and Tmux-driven C2 Interface](https://github.com/audibleblink/gorsh)
* [quasar/QuasarRAT - Remote Administration Tool for Windows - 要求 DotNet 4.X；powershell 2 反弹有bug，垃圾](https://github.com/quasar/QuasarRAT)
* [Ne0nd0g/merlin - Merlin is a cross-platform post-exploitation HTTP/2 Command & Control server and agent written in golang](https://github.com/Ne0nd0g/merlin)
* [Viralmaniar/Powershell-RAT - Python based backdoor that uses Gmail to exfiltrate data through attachment](https://github.com/Viralmaniar/Powershell-RAT)
* [Dviros/RAT-via-Telegram - Windows Remote Post Breach Tool via Telegram](https://github.com/Dviros/RAT-via-Telegram)
* [n1nj4sec/pupy - an opensource, cross-platform (Windows, Linux, OSX, Android) remote administration and post-exploitation tool mainly written in python](https://github.com/n1nj4sec/pupy)
* [nathanlopez/Stitch - A Python Remote Administration Tool (RAT)](https://github.com/nathanlopez/Stitch)
* [trustedsec/trevorc2 - a legitimate website (browsable) that tunnels client/server communications for covert command execution](https://github.com/trustedsec/trevorc2)
* [bkup/SlackShell - PowerShell to Slack C2](https://github.com/bkup/SlackShell)
* [maldevel/canisrufus - A stealthy Python based Windows backdoor that uses Github as a command and control server](https://github.com/maldevel/canisrufus)
* [Mr-Un1k0d3r/ThunderShell - Python / PowerShell based RAT](https://github.com/Mr-Un1k0d3r/ThunderShell)
* [byt3bl33d3r/gcat - A PoC backdoor that uses Gmail as a C&C server](https://github.com/byt3bl33d3r/gcat)
* [NYAN-x-CAT/Lime-RAT - Simple, yet powerful remote administration tool for Windows](https://github.com/NYAN-x-CAT/Lime-RAT)
* [cobbr/Covenant - a .NET command and control framework that aims to highlight the attack surface of .NET](https://github.com/cobbr/Covenant)
  * [介绍文章: Entering a Covenant: .NET Command and Control](https://posts.specterops.io/entering-a-covenant-net-command-and-control-e11038bcf462)
* [0blio/caesarRAT - An HTTP based RAT (Remote Administration Tool) that allows you to remotely control devices from your browser](https://github.com/0blio/caesarRAT)
* [Coalfire-Research/Slackor - A Golang implant that uses Slack as a command and control server](https://github.com/Coalfire-Research/Slackor)
* [0x00-0x00/NamedPipes - Bind shell that uses Named Pipes as transport and execute PowerShell code through Runspaces - 基于SMB命名管道通信，需要走Windows认证](https://github.com/0x00-0x00/NamedPipes)
* [its-a-feature/Apfell - A collaborative, multi-platform, red teaming framework](https://github.com/its-a-feature/Apfell)
  * [xorrior/poseidon - Apfell Golang macOS/Linux/Windows implant](https://github.com/xorrior/poseidon)

RAT - OSX

* [Marten4n6/EvilOSX - An evil RAT (Remote Administration Tool) for macOS / OS X](https://github.com/Marten4n6/EvilOSX)
* [neoneggplant/EggShell - iOS/macOS/Linux Remote Administration Tool](https://github.com/neoneggplant/EggShell)
* [cedowens/MacShell - MacShell post exploitation tool for macOS. Author: Cedric Owens](https://github.com/cedowens/MacShell)

RAT - Commercial

* [Remcos Remote Control | Breaking Security](https://breaking-security.net/remcos/)

WMI

* [Sw4mpf0x/PowerLurk - Malicious WMI Events using PowerShell](https://github.com/Sw4mpf0x/PowerLurk)
* [gist: Fileless WMI persistence payload template](https://gist.github.com/mattifestation/e55843eef6c263608206)
  * [n0pe-sled/WMI-Persistence - an adoption of @mattifestion's work](https://github.com/n0pe-sled/WMI-Persistence/blob/master/WMI-Persistence.ps1)

Registry

* [ewhitehats/InvisiblePersistence - Persisting in the Windows registry "invisibly"](https://github.com/ewhitehats/InvisiblePersistence)
* [outflanknl/SharpHide - Just a nice persistence trick to confuse DFIR investigation](https://github.com/outflanknl/SharpHide)

Rootkit - general

* [yungtravla/sewers - Cross-platform rootkit framework](https://github.com/yungtravla/sewers)

Rootkit - Linux

* [d30sa1/RootKits-List-Download - 很乱的列表](https://github.com/d30sa1/RootKits-List-Download)
* [milabs/awesome-linux-rootkits](https://github.com/milabs/awesome-linux-rootkits)
* [cloudsec/brootkit - Lightweight rootkit implemented by bash shell scripts v0.10](https://github.com/cloudsec/brootkit)
* [CDuPlooy/Rootkit - a special kind of malware with it's own custom bootloader](https://github.com/CDuPlooy/Rootkit)
* [mempodippy/vlany - Linux LD_PRELOAD rootkit (x86 and x86_64 architectures)](https://github.com/mempodippy/vlany)
* [naworkcaj/bdvl - LD_PRELOAD Linux rootkit (x86 & ARM)](https://github.com/naworkcaj/bdvl)
* [gianlucaborello/libprocesshider - Hide a process under Linux using the ld preloader](https://github.com/gianlucaborello/libprocesshider)
* [Screetsec/Vegile - simple LD_PRELOAD backdoor](https://github.com/Screetsec/Vegile)
* [iansus/hideproc-lkm - Linux 4.9 Loadable Kernel Module to hide processes from system utilities](https://github.com/iansus/hideproc-lkm)
* [f0rb1dd3n/Reptile - LKM Linux rootkit - 居然带了个 inline hook，不过只有x86，所以没啥用](https://github.com/f0rb1dd3n/Reptile)
* [m0nad/Diamorphine - a LKM rootkit for Linux Kernels 2.6.x/3.x/4.x](https://github.com/m0nad/Diamorphine)
* [maK-/maK_it-Linux-Rootkit - This is a linux rootkit using many techniques (2016 年的，太老了，只做个参考)](https://github.com/maK-/maK_it-Linux-Rootkit)
* [Eterna1/puszek-rootkit - Yet another LKM rootkit for Linux. It hooks syscall table](https://github.com/Eterna1/puszek-rootkit)
* [mncoppola/suterusu - An LKM rootkit targeting Linux 2.6/3.x on x86/x64/ARM - 用的ioctl hook方式](https://github.com/mncoppola/suterusu)
* [jiayy/lkm-rootkit - 源码主体源于国外一位大牛写的 suterusu，在此基础上添加了mips架构的支持，以及进程免杀、文件免杀等功能](https://github.com/jiayy/lkm-rootkit)

Rootkit - Windows

* [0xbaadf00d/deadlands-windows-dkom - Windows DKOM : Hide Processus](https://github.com/0xbaadf00d/deadlands-windows-dkom)
* [devoteam-fr/CERT - kernel process hiding POC](https://github.com/devoteam-fr/CERT)
* [zerosum0x0/smbdoor - kernel backdoor via registering a malicious SMB handler](https://github.com/zerosum0x0/smbdoor)

Rootkit - FreeBSD

* [josephjkong/designing-bsd-rootkits - Code from the book "Designing BSD Rootkits: An Introduction to Kernel Hacking"](https://github.com/josephjkong/designing-bsd-rootkits)

Rootkit - MacOS

* [HackerFantastic/Public - rootkits](https://github.com/HackerFantastic/Public/tree/master/rootkits)

Windows generic

* [blog: Quickpost: Running a Service DLL - 如何使用svchost加载DLL服务](https://blog.didierstevens.com/2019/10/29/quickpost-running-a-service-dll/)

ACL backdoors

* [HarmJ0y/DAMP - The Discretionary ACL Modification Project: Persistence Through Host-based Security Descriptor Modification](https://github.com/HarmJ0y/DAMP)
* [samratashok/RACE - a PowerShell module for executing ACL attacks against Windows targets](https://github.com/samratashok/RACE)
* [LycorisGuard/Windows-Rootkits - 多种后门原型，只能作为参考](https://github.com/LycorisGuard/Windows-Rootkits)

COM

* [gist: countercept/Get-LibraryMS.ps1 - Checks the %USERPROFILE% directory for any file with library-ms extension and extract the CLSID](https://gist.github.com/countercept/6890be67e09ba3daed38fa7aa6298fdf)
* [darkw1z/Ps1jacker - Ps1jacker is a tool for generating COM Hijacking payload](https://github.com/darkw1z/Ps1jacker)
* [leoloobeek/COMProxy - PoC for proxying COM objects when hijacking](https://github.com/leoloobeek/COMProxy)
* [nccgroup/acCOMplice - Tools for discovery and abuse of COM hijacks](https://github.com/nccgroup/acCOMplice)

Package distrubition backdoors

* [mschwager/0wned - Code execution via Python package installation](https://github.com/mschwager/0wned)
* Java
  * [airman604/jdbc-backdoor - A fake JDBC driver that allows OS command execution](https://github.com/airman604/jdbc-backdoor)
* Mac
  * [ahhh/macOS_profiles - a collection of profiles for macOS designed for penetration testing or red teaming](https://github.com/ahhh/macOS_profiles)
    * [blog: MacOS Red Teaming 202: Profiles](http://lockboxx.blogspot.com/2019/03/macos-red-teaming-202-profiles.html)

Driver loader - Windows

* [SamLarenN/CPUZ-DSEFix - Exploiting CPU-Z Driver To Turn Load Unsigned Drivers](https://github.com/SamLarenN/CPUZ-DSEFix)
* [hfiref0x/TDL - Driver loader for bypassing Windows x64 Driver Signature Enforcement](https://github.com/hfiref0x/TDL)
* [shjalayeri/DriveCrypt - DriveCrypt Dcr.sys vulnerability exploit](https://github.com/shjalayeri/DriveCrypt)
* Capcom
  * [tandasat/ExploitCapcom - a standalone exploit for a vulnerable feature in Capcom.sys](https://github.com/tandasat/ExploitCapcom)
  * [notscimmy/libcapcom - Capcom driver exploit wrapper](https://github.com/notscimmy/libcapcom)
  * [FuzzySecurity/Capcom-Rootkit - Capcom Rootkit Proof-Of-Concept](https://github.com/FuzzySecurity/Capcom-Rootkit)
  * [ihack4falafel/OSEE - Kernel Exploitation/Capcom](https://github.com/ihack4falafel/OSEE/tree/master/Kernel%20Exploitation/Capcom)
* [huoji120/GpuzMaper - using gpuz to load driver](https://github.com/huoji120/GpuzMaper)
* [Professor-plum/Reflective-Driver-Loader - a injection technique base off Reflective DLL injection by Stephen Fewer.](https://github.com/Professor-plum/Reflective-Driver-Loader)
* [shjalayeri/DriveCrypt - DriveCrypt Dcr.sys vulnerability exploit](https://github.com/shjalayeri/DriveCrypt)
* [DoubleLabyrinth/SdoKeyCrypt-sys-local-privilege-elevation - SdoKeyCrypt.sys - Local Privilege Elevation Vulnerability - 只是POC，带驱动文件](https://github.com/DoubleLabyrinth/SdoKeyCrypt-sys-local-privilege-elevation)
* 其他未测试的内核驱动漏洞
  * [Barakat/CVE-2019-16098 - Local privilege escalation PoC exploit for CVE-2019-16098](https://github.com/Barakat/CVE-2019-16098)


