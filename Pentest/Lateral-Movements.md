Uncategorized

* [Pennyw0rth/NetExec - The Network Execution Tool](https://github.com/Pennyw0rth/NetExec)
* [FalconOpsLLC/goexec - GoExec is a new take on some of the methods used to gain remote execution on Windows devices. GoExec implements a number of largely unrealized execution methods and provides significant OPSEC improvements overall - 替代impacket的工具](https://github.com/FalconOpsLLC/goexec)
* [tasox/LogRM - LogRM is a post exploitation powershell script which it uses windows event logs to gather information about internal network](https://github.com/tasox/LogRM)
* [maaaaz/impacket-examples-windows - The great impacket example scripts compiled for Windows](https://github.com/maaaaz/impacket-examples-windows)
  * [blog: Remote NTLM relaying through meterpreter on Windows port 445 - ntmlrelayx 可以跟 proxychains 一起用: 一边监听转发过来的端口，一边走socks5给受害者发请求](https://diablohorn.com/2018/08/25/remote-ntlm-relaying-through-meterpreter-on-windows-port-445/)
* [securifera/serviceFu - Automates credential skimming from service accounts in Windows Registry，远程注册表 + SC](https://github.com/securifera/serviceFu)
* [pentestpartners: Abusing RDP’s Remote Credential Guard with Rubeus PTT - 本机用ksetup设置DC地址，本地ptt后走代理连接。方案不如impacket简单，仅作为参考](https://www.pentestpartners.com/security-blog/abusing-rdps-remote-credential-guard-with-rubeus-ptt/)

SCCM

* [garrettfoster13/mssqlkaren - modified mssqlclient from impacket to extract policies from the SCCM database](https://github.com/garrettfoster13/mssqlkaren)
* [Mayyhem/SharpSCCM - A C# utility for interacting with SCCM](https://github.com/Mayyhem/SharpSCCM)
* [xpn/sccmwtf - 创建机器账号然后拉取SCCM策略，并解密敏感字段](https://github.com/xpn/sccmwtf)
* [nettitude/MalSCCM - abuse local or remote SCCM servers to deploy malicious applications to hosts they manage](https://github.com/nettitude/MalSCCM)

DCOM

* [rtecCyberSec/BitlockMove - Lateral Movement via Bitlocker DCOM interfaces & COM Hijacking](https://github.com/rtecCyberSec/BitlockMove)
* [AlmondOffSec/DCOMRunAs - Lateral movement with DCOM DLL hijacking](https://github.com/AlmondOffSec/DCOMRunAs)
* [cube0x0/SharpSystemTriggers - Collection of remote authentication triggers in C# - DCOM/EFSRPC/Spooler三种远程认证触发工具，包含SharpSpoolTrigger、SharpEfsTrigger、SharpDcomTrigger三个程序](https://github.com/cube0x0/SharpSystemTriggers)
* [r35tart/GetIPinfo - 用于寻找多网卡主机方便内网跨网段渗透避免瞎打找不到核心网 - 使用impacket调用ObjectExporter::ServerAlive2接口获取IP信息](https://github.com/r35tart/GetIPinfo)
* [Haboob Team: Abusing COM & DCOM objects](https://dl.packetstormsecurity.net/papers/general/abusing-objects.pdf)
* [ScorpionesLabs/DVS - D(COM) V(ulnerability) S(canner) AKA Devious swiss army knife - Lateral movement using DCOM Objects](https://github.com/ScorpionesLabs/DVS)
* [codewhitesec/LethalHTA - Lateral Movement technique using DCOM and HTA](https://github.com/codewhitesec/LethalHTA)
* [hausec/COMMethodSearcher - Script that searches through all COM objects for any methods containing a key word of your choosing](https://github.com/hausec/COMMethodSearcher)
* [sud0woodo/DCOMrade - Powershell script for enumerating vulnerable DCOM Applications](https://github.com/sud0woodo/DCOMrade)
* [outflanknl/Excel4-DCOM - PowerShell and Cobalt Strike scripts for lateral movement using Excel 4.0 / XLM macros via DCOM (direct shellcode injection in Excel.exe)](https://github.com/outflanknl/Excel4-DCOM)
* [rvrsh3ll/SharpExcel4-DCOM - Port of Invoke-Excel4DCOM](https://github.com/rvrsh3ll/SharpExcel4-DCOM)
* [sud0Ru/impacket-dcom - Adjusted version of the impacket-dcomexec script to work against Windows 10](https://github.com/sud0Ru/impacket-dcom)
* [deepinstinct/DCOMUploadExec - DCOM Lateral movement POC abusing the IMsiServer interface - uploads and executes a payload remotely](https://github.com/deepinstinct/DCOMUploadExec)
* [Ridter/atexec-pro - Fileless atexec, no more need for port 445](https://github.com/Ridter/atexec-pro)
* [HarmJ0y/SharpMove - .NET Project for performing Authenticated Remote Execution](https://github.com/HarmJ0y/SharpMove)
* [OmriBaso/WTSImpersonator - WTSImpersonator utilizes WTSQueryUserToken to steal user tokens by abusing the RPC Named Pipe "\\pipe\LSM_API_service"](https://github.com/OmriBaso/WTSImpersonator)
* [UNORTHODOX LATERAL MOVEMENT: STEPPING AWAY FROM STANDARD TRADECRAFT - 介绍了一些不常见的DCOM接口](https://github.com/RiccardoAncarani/talks/blob/master/F-Secure/unorthodox-lateral-movement.pdf)
* [klezVirus/CheeseTools - Self-developed tools for Lateral Movement/Code Execution - 都是基础工具，DCOM/RDP/MSSQL CLR](https://github.com/klezVirus/CheeseTools)
* [m8r0wn/nullinux - Internal penetration testing tool for Linux that can be used to enumerate OS information, domain information, shares, directories, and users through SMB - 命令行调用smbclient/rpcclient实现的](https://github.com/m8r0wn/nullinux)
* [RiccardoAncarani/LiquidSnake - a tool that allows operators to perform fileless lateral movement using WMI Event Subscriptions and GadgetToJScript - WMI远程执行，类型选vbscript](https://github.com/RiccardoAncarani/LiquidSnake)
* [cube0x0/SharpMapExec - A sharpen version of CrackMapExec](https://github.com/cube0x0/SharpMapExec)
* [0xthirteen/SharpMove - 这个更全面一些，DCOM/WMI执行vbs/远程计划任务/远程修改现有服务/远程注册表改COM](https://github.com/0xthirteen/SharpMove)
* [RiccardoAncarani/TaskShell - 远程计划任务调用](https://github.com/RiccardoAncarani/TaskShell)

WinRM

* [mez-0/CSharpWinRM - .NET 4.0 WinRM API Command Execution](https://github.com/mez-0/CSharpWinRM)
* [Hackplayers/evil-winrm - The ultimate WinRM shell for hacking/pentesting - impacket没有winrm工具，这个有3K star，可惜是ruby实现](https://github.com/Hackplayers/evil-winrm)
* [packer-community/winrmcp - Copy files to a remote host using WinRM](https://github.com/packer-community/winrmcp)
* [bohops/WSMan-WinRM - A collection of proof-of-concept source code and scripts for executing remote commands over WinRM using the WSMan.Automation COM object](https://github.com/bohops/WSMan-WinRM)

WMI

* [xorrior/RemoteRecon - provides the ability to execute post-exploitation capabilities against a remote host, without having to expose your complete toolkit/agent - 2017停更，用的 DotNetToJscript + WMI](https://github.com/xorrior/RemoteRecon)
* [hitb2018ams: No Win32_Process Needed - 就讲了一个WMI class继承，绕过检测的思路](https://conference.hitb.org/hitbsecconf2018ams/materials/D2T1%20-%20Philip%20Tsukerman%20-%20Expanding%20Your%20WMI%20Lateral%20Movement%20Arsenal.pdf)
* [0xbadjuju/WheresMyImplant - A Bring Your Own Land Toolkit that Doubles as a WMI Provider](https://github.com/0xbadjuju/WheresMyImplant)
* [FortyNorthSecurity/CIMplant - C# port of WMImplant which uses either CIM or WMI to query remote systems](https://github.com/FortyNorthSecurity/CIMplant)
* [secabstraction/WmiSploit - a small set of PowerShell scripts that leverage the WMI service, for post-exploitation use](https://github.com/secabstraction/WmiSploit)
* [XiaoliChan/wmiexec-Pro - The new generation of wmiexec.py, more new features, whole the operations only work with port 135 (don't need smb connection) for AV evasion in lateral movement (Windows Defender, HuoRong, 360) - 1K star](https://github.com/XiaoliChan/wmiexec-Pro)
* [Cybereason/Invoke-WMILM - a PoC script for various methods to acheive authenticated remote code execution via WMI, without (at least directly) using the Win32_Process class](https://github.com/Cybereason/Invoke-WMILM)
* [360-Linton-Lab/WMIHACKER - A Bypass Anti-virus Software Lateral Movement Command Execution Tool](https://github.com/360-Linton-Lab/WMIHACKER)
* [checkymander/Sharp-InvokeWMIExec - A native C# conversion of Kevin Robertsons Invoke-WMIExec powershell script.](https://github.com/checkymander/Sharp-InvokeWMIExec/)
* [FortyNorthSecurity/WMIOps - a powershell script which uses WMI for various purposes across a network](https://github.com/FortyNorthSecurity/WMIOps)
* [QAX-A-Team/sharpwmi - sharpwmi是一个基于rpc的横向移动工具，具有上传文件和执行命令功能 - 包含 WMI StdRegProv csharp 调用例子](https://github.com/QAX-A-Team/sharpwmi)
* [rchaganti/CimUtils - Set of CIM utilities that can be used to make it easy to work with CIM classes](https://github.com/rchaganti/CimUtils)
* [FortyNorthSecurity/WMImplant - a PowerShell based tool that is designed to act like a RAT](https://github.com/FortyNorthSecurity/WMImplant)

Coerce authentication

* [https://github.com/decoder-it/printerbugnew - The DCERPC only printerbug.py version](https://github.com/decoder-it/printerbugnew)
* [RedTeamPentesting/wspcoerce - coerces a Windows computer account via SMB to an arbitrary target using MS-WSP](https://github.com/RedTeamPentesting/wspcoerce)
* [Thunter-HackTeam/EvilentCoerce - A practical NTLM relay attack using the MS-EVEN RPC protocol and antivirus-assisted coercion](https://github.com/Thunter-HackTeam/EvilentCoerce)
* [Wh04m1001/DFSCoerce - PoC for MS-DFSNM coerce authentication using NetrDfsRemoveStdRoot and NetrDfsAddStdRoot (found by @xct_de) methods](https://github.com/Wh04m1001/DFSCoerce)
* [decoder-it/DFSCoerce-exe-2 - DFSCoerce exe revisited version with custom authentication](https://github.com/decoder-it/DFSCoerce-exe-2)
* [slemire/WSPCoerce - PoC to coerce authentication from Windows hosts using MS-WSP](https://github.com/slemire/WSPCoerce)
* [p0dalirius/Coercer - A python script to automatically coerce a Windows server to authenticate on an arbitrary machine through 9 methods - 支持 DFSNM/EFSR/FSRVP/RPRN 4种协议](https://github.com/p0dalirius/Coercer)
* [p0dalirius/windows-coerced-authentication-methods - A list of methods to coerce a windows machine to authenticate to an attacker-controlled machine through a Remote Procedure Call (RPC) with various protocols](https://github.com/p0dalirius/windows-coerced-authentication-methods)
* [p0dalirius/MSSQL-Analysis-Coerce - A technique to coerce a Windows SQL Server to authenticate on an arbitrary machine - 这个是NTLMv2 SSP HASH](https://github.com/p0dalirius/MSSQL-Analysis-Coerce)
* [akamai/akamai-security-research/cve-2022-30216: Server Service Authentication Coerce Vulnerability](https://github.com/akamai/akamai-security-research/tree/main/cve-2022-30216)

WebDAV

* [xforcered/GetWebDAVStatus - Determine if the WebClient Service (WebDAV) is running on a remote system - 尝试访问远程 \pipe\DAV RPC SERVICE 管道来判断](https://github.com/xforcered/GetWebDAVStatus)

SMB

* [Leo4j/Invoke-SMBRemoting - Interactive Shell and Command Execution over Named-Pipes (SMB) for Fileless lateral movement](https://github.com/Leo4j/Invoke-SMBRemoting)
* [tothi/serviceDetector - Detect whether a service is installed (blindly) and/or running (if exposing named pipes) on a remote machine without using local admin privileges - 使用低权限账号检查远程服务是否存在、远程命名管道是否存在，以此来判断是否安装了某种终端防护软件](https://github.com/tothi/serviceDetector)
* [juliourena/SharpNoPSExec - Get file less command execution for lateral movement - 随机挑选禁用或者手动启动的服务，修改后执行命令，最后再还原改动](https://github.com/juliourena/SharpNoPSExec)
* [SnaffCon/Snaffler - a tool for pentesters to help find delicious candy - 1.1K star](https://github.com/SnaffCon/Snaffler)
* [NetSPI/PowerHuntShares - PowerHuntShares is an audit script designed in inventory, analyze, and report excessive privileges configured on Active Directory domains](https://github.com/NetSPI/PowerHuntShares)
* [p0dalirius/pyFindUncommonShares - FindUncommonShares.py is a Python equivalent of PowerView's Invoke-ShareFinder.ps1](https://github.com/p0dalirius/pyFindUncommonShares)
  * https://github.com/LaresLLC/SuperSharpShares
  * https://github.com/mitchmoser/SharpShares
* [S3cur3Th1sSh1t/NamedPipePTH - Pass the Hash to a named pipe for token Impersonation](https://github.com/S3cur3Th1sSh1t/NamedPipePTH)
* [S3cur3Th1sSh1t/SharpNamedPipePTH - Pass the Hash to a named pipe for token Impersonation](https://github.com/S3cur3Th1sSh1t/SharpNamedPipePTH)
* [anthemtotheego/SharpExec - PSExec/WMIExec 实现](https://github.com/anthemtotheego/SharpExec)
* [zesiar0/MyPsExec - MyPsExec是根据Sysinternal Suite中的PsExec提供的功能实现的demo，仅供学习参考](https://github.com/zesiar0/MyPsExec)
* [portcullislabs/enum4linux - a Linux alternative to enum.exe for enumerating data from Windows and Samba hosts - 需要开启NULL Session才能利用，用处不大了](https://github.com/portcullislabs/enum4linux)
* [cddmp/enum4linux-ng - A next generation version of enum4linux (a Windows/Samba enumeration tool) with additional features like JSON/YAML export. Aimed for security professionals and CTF players](https://github.com/cddmp/enum4linux-ng)
* [ShawnDEvans/smbmap - SMBMap is a handy SMB enumeration tool - 不要测试域控，sysvol默认可写不可删除](https://github.com/ShawnDEvans/smbmap)
* [kavika13/RemCom - Remote Command Executor: A OSS replacement for PsExec and RunAs - or Telnet without having to install a server](https://github.com/kavika13/RemCom)
* [shirosaidev/sharesniffer - Network share sniffer and auto-mounter for crawling remote file systems](https://github.com/shirosaidev/sharesniffer)
* [Mr-Un1k0d3r/SCShell - 使用 LogonUser + ChangeServiceConfigA 远程修改服务，并执行命令](https://github.com/Mr-Un1k0d3r/SCShell)
* [poweradminllc/PAExec - Remote execution, like PsExec](https://github.com/poweradminllc/PAExec)

Kerberos

* [Zer1t0/cerbero - Kerberos protocol attacker - 这个rust写的，可以在linux下面执行s4u](https://github.com/Zer1t0/cerbero)
* [ShutdownRepo/targetedKerberoast - Kerberoast with ACL abuse capabilities](https://github.com/ShutdownRepo/targetedKerberoast)
* [rvazarkar/KrbCredExport - Exports Kerberos KrbCred Tickets for use in Mimikatz/Beacon from a Kerberos CCache File](https://github.com/rvazarkar/KrbCredExport)
* [machosec/Mystique - PowerShell module to play with Kerberos S4U extensions](https://github.com/machosec/Mystique)
* [gentilkiwi/kekeo - A little toolbox to play with Microsoft Kerberos in C](https://github.com/gentilkiwi/kekeo)
* [ropnop/kerbrute - A tool to perform Kerberos pre-auth bruteforcing - AD默认不记录4771失败日志，而且这个爆破更快](https://github.com/ropnop/kerbrute)
* [Zer1t0/ticket_converter - A little tool to convert ccache tickets into kirbi (KRB-CRED) and vice versa based on impacket](https://github.com/Zer1t0/ticket_converter)
* [pkb1s/SharpAllowedToAct - Computer object takeover through Resource-Based Constrained Delegation (msDS-AllowedToActOnBehalfOfOtherIdentity)](https://github.com/pkb1s/SharpAllowedToAct)
* [Ridter/SharpAddDomainMachine - The same script as SharpAllowedToAct, but more usefully for local privilege escalation](https://github.com/Ridter/SharpAddDomainMachine)
* [the-useless-one/pywerview - A (partial) Python rewriting of PowerSploit's PowerView](https://github.com/the-useless-one/pywerview)
* [tevora-threat/SharpView - C# implementation of harmj0y's PowerView](https://github.com/tevora-threat/SharpView)
* [nidem/kerberoast - 这个是纯手动利用方案，只保留做参考](https://github.com/nidem/kerberoast)
  * [EmpireProject/Empire - data/module_source/credentials/Invoke-Kerberoast.ps1 - harmj0y 实现的，已经被 Rubeus 取代](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1)
* [skelsec/kerberoast - Kerberoast attack -pure python-](https://github.com/skelsec/kerberoast)
* [GhostPack/Rubeus - Trying to tame the three-headed dog](https://github.com/GhostPack/Rubeus/)
* [cyberark/RiskySPN - Detect and abuse risky SPNs](https://github.com/cyberark/RiskySPN)
* [ccache2john.py - ccache也可以爆破](https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/ccache2john.py)
* [dirkjanm/krbrelayx - Kerberos unconstrained delegation abuse toolkit](https://github.com/dirkjanm/krbrelayx)
  * [Relaying Kerberos - Having fun with unconstrained delegation](https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/)
* [3gstudent/pyKerbrute - Use python to perform Kerberos pre-auth bruteforcing](https://github.com/3gstudent/pyKerbrute)
* [redsiege.com: Kerberos & Attacks 101](https://www.redsiege.com/wp-content/uploads/2020/04/20200430-kerb101.pdf)
* [tothi/rbcd-attack - Kerberos Resource-Based Constrained Delegation Attack from Outside using Impacket - 机器账号可以修改自己的delegation权限，所以做个假机器账号，然后CIFS上去执行命令](https://github.com/tothi/rbcd-attack)

PTH

* [GhostPack/Koh - The Token Stealer](https://github.com/GhostPack/Koh)
* [BeichenDream/SharpToken - .NET版本的incognito](https://github.com/BeichenDream/SharpToken)
* [byt3bl33d3r/pth-toolkit - Modified version of the passing-the-hash tool collection made to work straight out of the box](https://github.com/byt3bl33d3r/pth-toolkit)
* [Kevin-Robertson/Invoke-TheHash - PowerShell Pass The Hash Utils](https://github.com/Kevin-Robertson/Invoke-TheHash)
* [mkellerman/Invoke-CommandAs - Invoke Command as System/User on Local/Remote computer using ScheduleTask](https://github.com/mkellerman/Invoke-CommandAs)

Printer

* [Universal Privilege Escalation and Persistence – Printer - 使用mimispool的代码例子创建恶意打印机驱动](https://pentestlab.blog/2021/08/02/universal-privilege-escalation-and-persistence-printer/)
  * [gentilkiwi/mimikatz - mimispool - 这里也有PS命令，跟上面应该一样的](https://github.com/gentilkiwi/mimikatz/tree/master/mimispool)
* [jacob-baines/concealed_position - Bring your own print driver privilege escalation tool](https://github.com/jacob-baines/concealed_position)
* [vletoux/SpoolerScanner - Check if MS-RPRN is remotely available with powershell/c#](https://github.com/vletoux/SpoolerScanner)
* [BusesCanFly/PRETty - "PRinter Exploitation Toolkit" LAN automation tool](https://github.com/BusesCanFly/PRETty)
* [syscall.e: Attacking Xerox multi function printers](https://syscall.eu/pdf/INFILTRATE2020-RIGO-Xerox-final.pdf)

Resources

* [shenaniganslabs.io: Wagging the Dog: Abusing Resource-Based Constrained Delegation to Attack Active Directory](https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html)
* [Kerberos Survival Guide](https://social.technet.microsoft.com/wiki/contents/articles/4209.kerberos-survival-guide.aspx)
* [Another Word on Delegation - 在ADSI里给计算机账号增加写权限，之后使用文中的脚本增加msDS-AllowedToDelegateTo设置，然后使用S4U+CIFS控制目标设备 - 假想场景，实战中较为罕见](https://blog.harmj0y.net/redteaming/another-word-on-delegation/)
* [Understanding Windows Lateral Movements - 目前关于Windows本地和远程认证讲的最清晰的PDF](https://attl4s.github.io/assets/pdf/Understanding_Windows_Lateral_Movements.pdf)
* [Resetting Expired Passwords Remotely](https://www.n00py.io/2021/09/resetting-expired-passwords-remotely/)
