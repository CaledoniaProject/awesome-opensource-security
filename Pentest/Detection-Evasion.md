Disable Endpoint Protection

* [SaadAhla/dark-kill - A user-mode code and its rootkit that will Kill EDR Processes permanently by leveraging the power of Process Creation Blocking Kernel Callback Routine registering and ZwTerminateProcess](https://github.com/SaadAhla/dark-kill)
* [es3n1n/no-defender - A slightly more fun way to disable windows defender + firewall. (through the WSC api) - 使用avast av的白程序让defender以为有杀毒软件在工作，然后就关闭了](https://github.com/es3n1n/no-defender)
* [ZeroMemoryEx/Blackout - kill anti-malware protected processes (BYOVD) - 用的GMER驱动，有签名](https://github.com/ZeroMemoryEx/Blackout)

EDR Evasion

* [PwnDexter/SharpEDRChecker - Checks running processes, process metadata, Dlls loaded into your current process and the each DLLs metadata, common install directories, installed services and each service binaries metadata, installed drivers and each drivers metadata, all for the presence of known defensive products such as AV's, EDR's and logging tools - 列表不全，仅作参考](https://github.com/PwnDexter/SharpEDRChecker)
* [netero1010/EDRSilencer - A tool uses Windows Filtering Platform (WFP) to block Endpoint Detection and Response (EDR) agents from reporting security events to the server](https://github.com/netero1010/EDRSilencer)
* [TwoSevenOneT/EDR-Freeze - EDR-Freeze is a tool that puts a process of EDR, AntiMalware into a coma state](https://github.com/TwoSevenOneT/EDR-Freeze)
* [MatheuZSecurity/RingReaper - Linux post-exploitation agent that uses io_uring to stealthily bypass EDR detection by avoiding traditional syscalls.](https://github.com/MatheuZSecurity/RingReaper)
* [MalwareTech/EDR-Preloader - An EDR bypass that prevents EDRs from hooking or loading DLLs into our process by hijacking the AppVerifier layer](https://github.com/MalwareTech/EDR-Preloader)
* [Ridter/RealBlindingEDR - Remove AV/EDR Kernel ObRegisterCallbacks、CmRegisterCallback、MiniFilter Callback、PsSetCreateProcessNotifyRoutine Callback、PsSetCreateThreadNotifyRoutine Callback、PsSetLoadImageNotifyRoutine Callback](https://github.com/Ridter/RealBlindingEDR)
* [tkmru/awesome-edr-bypass - Awesome EDR Bypass Resources For Ethical Hacking](https://github.com/tkmru/awesome-edr-bypass)
* [deepinstinct/ContainYourself - A POC of the ContainYourself research presented in DEF CON 31, which abuses the Windows containers framework to bypass EDRs - 创建容器来绕过MiniFilter检测](https://github.com/deepinstinct/ContainYourself)
* [dslee2022/SignatureKid - Signature Kid is a header only tool that steals a signature from a file and copy it to whathever file you want - 复制PE证书目录，然后修改注册表屏蔽证书验证](https://github.com/dslee2022/SignatureKid)
* [iamagarre/BadExclusionsNWBO - BadExclusionsNWBO is an evolution from BadExclusions to identify folder custom or undocumented exclusions on AV/EDR - 找EDR钩子白名单的，有用](https://github.com/iamagarre/BadExclusionsNWBO)
* [lap1nou/CLR_Heap_encryption - This is a POC for a CLR sleep obfuscation attempt. It use IHostMemoryManager interface to control the memory allocated by the CLR. Turns out you can use both ICorRuntimeHost and ICLRRuntimeHost at the same time, so we can still use ICorRuntimeHost to run an assembly from memory while having all the benefits from ICLRRuntimeHost](https://github.com/lap1nou/CLR_Heap_encryption)
* [ASkyeye/UnlinkDLL - DLL Unlinking from InLoadOrderModuleList, InMemoryOrderModuleList, InInitializationOrderModuleList, and LdrpHashTable](https://github.com/ASkyeye/UnlinkDLL)
* [Mr-Un1k0d3r/.NetConfigLoader - List of .Net application signed by Microsoft that can be used to load a dll via a .config file. Ideal for EDR/AV evasion and execution policy bypass - DLL有签名就能加载](https://github.com/Mr-Un1k0d3r/.NetConfigLoader)
* [BlackSnufkin/NovaLdr - Threadless Module Stomping In Rust with some features (In memory of those murdered in the Nova party massacre)](https://github.com/BlackSnufkin/NovaLdr)
* [gtworek/PSBits: FakeOwnCmdLine.c - 修改PEB伪造命令行参数](https://github.com/gtworek/PSBits/blob/master/FakeCmdLine/FakeOwnCmdLine.c)
* [f1zm0/acheron - indirect syscalls for AV/EDR evasion in Go assembly](https://github.com/f1zm0/acheron)
* [Dec0ne/HWSyscalls - HWSyscalls is a new method to execute indirect syscalls using HWBP, HalosGate and a synthetic trampoline on kernel32 with HWBP](https://github.com/Dec0ne/HWSyscalls)
* [JustasMasiulis/inline_syscall - Header only library that allows you to generate direct syscall instructions in an optimized, inlineable and easy to use manner](https://github.com/JustasMasiulis/inline_syscall)
* [ired.team: Retrieving ntdll Syscall Stubs from Disk at Run-time](https://ired.team/offensive-security/defense-evasion/retrieving-ntdll-syscall-stubs-at-run-time)
* [bananabr/TimeException - A tool to find folders excluded from AV real-time scanning using a time oracle](https://github.com/bananabr/TimeException)
* [optiv/Freeze - a payload toolkit for bypassing EDRs using suspended processes, direct syscalls, and alternative execution methods](https://github.com/optiv/Freeze)
* [Ciyfly/microwaveo - 将dll exe 等转成shellcode 最后输出exe 可定制加载器模板 支持白文件的捆绑 shellcode 加密](https://github.com/Ciyfly/microwaveo)
* [rad9800/TamperingSyscalls - TamperingSyscalls is a 2 part novel project consisting of argument spoofing and syscall retrival which both abuse EH in order to subvert EDRs](https://github.com/rad9800/TamperingSyscalls)
* [trickster0/TartarusGate - TartarusGate, Bypassing EDRs](https://github.com/trickster0/TartarusGate)
* [RedTeamOperations/Journey-to-McAfee - 使用mcafee的DLL来实现进程注入，执行过程中mcafee不会有报警](https://github.com/RedTeamOperations/Journey-to-McAfee)
* [ytk2128/dll-merger - Merging DLLs with a PE32 EXE without LoadLibrary - 直接修改PE结构，来实现DLL和PE合并，不知道是否所有场景都能用](https://github.com/ytk2128/dll-merger)
* [mdsecactivebreach/ParallelSyscalls - EDR Parallel-asis through Analysis - ntdll!LdrpThunkSignature用来检测函数是否被挂钩，可以用于构造syscall](https://github.com/mdsecactivebreach/ParallelSyscalls/)
* [y11en/PEBFake - PEBFake(修改PEB 伪装当前进程路径、参数等)](https://github.com/y11en/PEBFake)
* [Cracked5pider/KaynLdr - KaynLdr is a Reflective Loader written in C/ASM - 基于syscall实现，完全手写的DLL注入，注入后执行手写的PE加载器，非常高级](https://github.com/Cracked5pider/KaynLdr)
* [wavestone-cdt/EDRSandblast - a tool written in C that weaponize a vulnerable signed driver to bypass EDR detections (Kernel callbacks and ETW TI provider) and LSASS protections. Multiple userland unhooking techniques are also implemented to evade userland monitoring - 最近发布了一个DefCon30Release分支](https://github.com/wavestone-cdt/EDRSandblast)
  * https://github.com/gabriellandau/EDRSandblast-GodFault
* [aaaddress1/Skrull - a malware DRM, that prevents Automatic Sample Submission by AV/EDR and Signature Scanning from Kernel. It generates launchers that can run malware on the victim using the Process Ghosting technique. Also, launchers are totally anti-copy and naturally broken when got submitted](https://github.com/aaaddress1/Skrull)
* [tanc7/EXOCET-AV-Evasion - AV-evading, undetectable, payload delivery tool](https://github.com/tanc7/EXOCET-AV-Evasion)
* https://www.cyberark.com/resources/threat-research-blog/hook-heaps-and-live-free
  * [Idov31/Cronos - PoC for a new sleep obfuscation technique leveraging waitable timers to evade memory scanners - 这个不是shellcode，是基于CreateWaitableTimerW的一个例子](https://github.com/Idov31/Cronos)
  * [janoglezcampos/DeathSleep - A PoC implementation for an evasion technique to terminate the current thread and restore it before resuming execution, while implementing page protection changes during no execution](https://github.com/janoglezcampos/DeathSleep)
  * [waldo-irc/LockdExeDemo - hook sleep函数，sleep时挂起所有其他线程，加密堆上分配的内存](https://github.com/waldo-irc/LockdExeDemo)
  * [SolomonSklash/SleepyCrypt - A shellcode function to encrypt a running process image when sleeping - 挨个处理PE节，通过XOR混淆](https://github.com/SolomonSklash/SleepyCrypt)
  * [mgeeky/ShellcodeFluctuation - An advanced in-memory evasion technique fluctuating shellcode's memory protection between RW/NoAccess & RX and then encrypting/decrypting its contents](https://github.com/mgeeky/ShellcodeFluctuation)
  * [IcebreakerSecurity/Ekko_CFG_Bypass - A PoC for adding NtContinue to the CFG allowed list in order to make callback-based sleep obfuscation techniques work in a CFG protected process - 这个兼容开启了CFG的程序，有一个64位SetProcessValidCallTargets的例子](https://github.com/IcebreakerSecurity/Ekko_CFG_Bypass)
  * [Kudaes/Shelter - ROP-based sleep obfuscation to evade memory scanners](https://github.com/Kudaes/Shelter)
* [klezVirus/inceptor - Template-Driven AV/EDR Evasion Framework](https://github.com/klezVirus/inceptor)
* [timwhitez/Doge-Assembly - Golang evasion tool, execute-assembly .Net file - DLL unhook/ETW禁用/blockdlls/父进程修改等等](https://github.com/timwhitez/Doge-Assembly)
* [Airboi/bypass-av-note - 免杀技术大杂烩---乱拳也打不死老师傅](https://github.com/Airboi/bypass-av-note)
* [Mr-Un1k0d3r/EDRs - information about EDRs that can be useful during red team exercise - 通过判断第一个指令是否为JMP来检查函数是否被Hook，并给出了多个EDR的hook列表](https://github.com/Mr-Un1k0d3r/EDRs)
* [s3cur3th1ssh1t: A tale of EDR bypass methods](https://s3cur3th1ssh1t.github.io/A-tale-of-EDR-bypass-methods/)
* [gist: theevilbit/divide_and_conquer.c - Divide and Conquer NextGen AV bypass - 方法太low了，无实战价值](https://gist.github.com/theevilbit/073ca4eb15383eb3254272fc24632efd)
* [gnxbr/Fully-Undetectable-Techniques - I will post here my research aiming Fully UnDetectable (FUD) techniques and tools - 大多是基于CreateDesktop的](https://github.com/gnxbr/Fully-Undetectable-Techniques)
* [ethereal-vx/Antivirus-Artifacts - Anti-virus artifacts. Listing APIs hooked by: Avira, BitDefender, F-Secure, MalwareBytes, Norton, TrendMicro, and WebRoot](https://github.com/ethereal-vx/Antivirus-Artifacts)
* [outflanknl/TamperETW - selectively forward .NET ETW events](https://github.com/outflanknl/TamperETW)
* [matterpreter/SHAPESHIFTER - 通过syscall绕过hook](https://github.com/matterpreter/SHAPESHIFTER)
* [ayoul3/reflect-pe - Reflectively load PE - 带一个关键词替换功能](https://github.com/ayoul3/reflect-pe)
* [scrt/avcleaner - C/C++ source obfuscator for antivirus bypass](https://github.com/scrt/avcleaner)
* [nickcano/ReloadLibrary - A quick-and-dirty anti-hook library proof of concept - 2018停更，这个是遍历和还原IAT Hook，没啥用](https://github.com/nickcano/ReloadLibrary)
* [CylanceVulnResearch/ReflectiveDLLRefresher - a standalone test harness for scanning the process's memory space and unhooking the currently loaded libraries，恢复AV钩子的](https://github.com/CylanceVulnResearch/ReflectiveDLLRefresher)
* [optiv/ScareCrow - Payload creation framework designed around EDR bypass - 也是从文件恢复钩子的方法](https://github.com/optiv/ScareCrow)
  * https://github.com/timwhitez/ScareCrow-Common
* [secretsquirrel/SigThief - Stealing Signatures and Making One Invalid Signature at a Time](https://github.com/secretsquirrel/SigThief)
* [rootm0s/Protectors - Obfuscator, Encryption, Junkcode, Anti-Debug, PE protection/modification](https://github.com/rootm0s/Protectors)
* [threatexpress/metatwin - a file resource cloner. Metadata, including digital signature, is extracted from one file and injected into another](https://github.com/threatexpress/metatwin)
* [Ekultek/Graffiti - A tool to generate obfuscated one liners to aid in penetration testing](https://github.com/Ekultek/Graffiti)
* [DiabloHorn/cliramdisk - A reduced functionality cli client for the imdisk ram disk driver](https://github.com/DiabloHorn/cliramdisk)
* [perturbed-platypus - EDR Is Coming; Hide yo Sh!t - 将payload存储到UEFI](https://github.com/perturbed-platypus)
* [AdrianVollmer/PowerHub - A web application to transfer PowerShell modules, executables, snippets and files while bypassing AV and application whitelisting - 支持EXE/PS1远程加载](https://github.com/AdrianVollmer/PowerHub)
* [DeEpinGh0st/AutoRemove - 利用PyautoGUI实现的对防病毒软件的自动化卸载](https://github.com/DeEpinGh0st/AutoRemove)
* [Red Team Tactics: Hiding Windows Services - 通过SetServiceObjectSecurity修改权限实现隐藏，测试不影响服务启动。](https://www.sans.org/blog/red-team-tactics-hiding-windows-services/)

Bypass AV Detection

* [Shellter - AV Evasion Artware](https://www.shellterproject.com/)
* [Hackplayers/Salsa-tools - ShellReverse TCP/UDP/ICMP/DNS/SSL/BINDTCP and AV bypass, AMSI patched](https://github.com/Hackplayers/Salsa-tools)
* [Ch0pin/AVIator - Antivirus evasion project](https://github.com/Ch0pin/AVIator)
* [Mr-Un1k0d3r/DKMC - DKMC - Dont kill my cat - Malicious payload evasion tool](https://github.com/Mr-Un1k0d3r/DKMC)
* [silentsignal/av-breaking - Bare Knuckled AV Breaking](https://github.com/silentsignal/av-breaking)
* [AbedAlqaderSwedan1/ASWCrypter - An Bash&Python Script For Generating Payloads that Bypasses All Antivirus so far FUD](https://github.com/AbedAlqaderSwedan1/ASWCrypter)
* [TideSec/BypassAntiVirus - 远控免杀系列文章及配套工具，搜集汇总了互联网上的几十种免杀工具和免杀方法 - 没啥用，只记录](https://github.com/TideSec/BypassAntiVirus)
* [the-xentropy/xencrypt - A PowerShell script anti-virus evasion tool](https://github.com/the-xentropy/xencrypt)
* [1y0n/AV_Evasion_Tool - 掩日 - 免杀执行器生成工具 - 1.5K star](https://github.com/1y0n/AV_Evasion_Tool)

Stack Spoofing

* [countercept/CallStackSpoofer - A PoC implementation for spoofing arbitrary call stacks when making sys calls (e.g. grabbing a handle via NtOpenProcess) - 创建线程，修改CONTEXT实现StackFrame伪造，最后用VEH从异常里恢复并让线程退出](https://github.com/countercept/CallStackSpoofer)
* [Cobalt-Strike/CallStackMasker - A PoC implementation for dynamically masking call stacks with timers](https://github.com/Cobalt-Strike/CallStackMasker)
* [susMdT/LoudSunRun - Stack Spoofing with Synthetic frames based on the work of namazso, SilentMoonWalk, and VulcanRaven](https://github.com/susMdT/LoudSunRun)
* [mgeeky/ThreadStackSpoofer - Thread Stack Spoofing - PoC for an advanced In-Memory evasion technique allowing to better hide injected shellcode's memory allocation from scanners and analysts - 跟上面的手段类似](https://github.com/mgeeky/ThreadStackSpoofer)
* [klezVirus/SilentMoonwalk - PoC Implementation of a fully dynamic call stack spoofer](https://github.com/klezVirus/SilentMoonwalk)

Windows Defender

* [S12cybersecurity/WinDefenderKiller - 修改注册表关闭defender监控](https://github.com/S12cybersecurity/WinDefenderKiller/tree/main)
* [EspressoCake/DefenderPathExclusions - Creation and removal of Defender path exclusions and exceptions in C# - 通过WMI操作，支持远程加白](https://github.com/EspressoCake/DefenderPathExclusions)
* [SafeBreach-Labs/wd-pretender - Compatible with Windows Defender platform version 4.18.2302.7 and earlier - 修改VDM特征码，删除特定规则实现免杀](https://github.com/SafeBreach-Labs/wd-pretender)
* [taviso/loadlibrary - Porting Windows Dynamic Link Libraries to Linux - 可以运行defender去扫描](https://github.com/taviso/loadlibrary)
* [f-secure: Bypassing Windows Defender Runtime Scanning - 使用 PAGE_NOACCESS 防止AV扫描](https://labs.f-secure.com/blog/bypassing-windows-defender-runtime-scanning/)
* [hfiref0x/WDExtract - Extract Windows Defender database from vdm files and unpack it - 2020停更，但是2022.03测试有效](https://github.com/hfiref0x/WDExtract)
* [commial/experiments/windows-defender - 包含ASR的分析和Luac转换工具，使用luadec可以反编译](https://github.com/commial/experiments/tree/master/windows-defender)
* [gist: mattifestation/ExpandDefenderSig.ps1 - Decompresses Windows Defender AV signatures for exploration purposes](https://gist.github.com/mattifestation/3af5a472e11b7e135273e71cb5fed866)
* [APTortellini/unDefender - Killing your preferred antimalware by abusing native symbolic links and NT paths - 启动TrustedInstaller服务，使用NtImpersonateThread切换token后，关闭WdFilter服务，之后利用软连接让Defender服务加载错误的驱动，实现杀软的关闭](https://github.com/APTortellini/unDefender)
  * [timwhitez/StopDefender - Stop Windows Defender programmatically - 原理类似](https://github.com/timwhitez/StopDefender)

EDR Telemetry

* [gist: jthuraisamy/loaded_psp_drivers.cpp - Loaded Security Product Drivers](https://gist.github.com/jthuraisamy/4c4c751df09f83d3620013f5d370d3b9)
* [jthuraisamy/TelemetrySourcerer - Enumerate and disable common sources of telemetry used by AV/EDR - 用驱动删除AV的回调和钩子 - 得自己编译](https://github.com/jthuraisamy/TelemetrySourcerer)
* [carbonblack/cbapi - server_apis/proto/sensor_events.proto - CB通信内容，2017年的PB定义，仅供参考](https://github.com/carbonblack/cbapi/blob/master/server_apis/proto/sensor_events.proto)
* [microsoft: Understand the advanced hunting schema in Microsoft Defender for Endpoint](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/advanced-hunting-schema-reference)
* [microsoft: Collect support logs in Microsoft Defender for Endpoint using live response - 原先的MDATPClientAnalyzer程序](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/troubleshoot-collect-support-log)

Restriction/Whitelist Bypass

* [bohops/UltimateWDACBypassList - A centralized resource for previously documented WDAC bypass techniques](https://github.com/bohops/UltimateWDACBypassList)
* [Mr-Un1k0d3r/Windows-SignedBinary - bypass endpoint solution that block known "malicious" signed application such as "regsvr32.exe" - 生成HASH不同，但是有微软签名的程序。方法是随机修改几个字节，检查签名是否还有效](https://github.com/Mr-Un1k0d3r/Windows-SignedBinary)
* [rootm0s/WinPwnage - Elevate, UAC bypass, persistence, privilege escalation, dll hijack techniques](https://github.com/rootm0s/WinPwnage)
* [SafeBreach-Labs/BACE - Mapping of Binaries that allows Arbitrary Code Execution](https://github.com/SafeBreach-Labs/BACE)
* [GreatSCT/GreatSCT - an open source project to generate application white list bypasses](https://github.com/GreatSCT/GreatSCT)
* [infosecn1nja/MaliciousMacroMSBuild - Generates Malicious Macro and Execute Powershell or Shellcode via MSBuild Application Whitelisting Bypass](https://github.com/infosecn1nja/MaliciousMacroMSBuild)
* [Jumbo-WJB/windows_exec_ways](https://github.com/Jumbo-WJB/windows_exec_ways)
* [gist: All System32 DLL export functions that contain "RunDLL", an indicator that it's designed to run with rundll32.exe](https://gist.github.com/mattifestation/27af49ff6b9ee6bbb21e4443310f70f5)
* [rvrsh3ll/CPLResourceRunner - Run shellcode from resource](https://github.com/rvrsh3ll/CPLResourceRunner)
* [fireeye/DueDLLigence - Shellcode runner for all application whitelisting bypasses](https://github.com/fireeye/DueDLLigence)
* [Neo23x0/DLLRunner - a smart DLL execution script for malware analysis in sandbox systems](https://github.com/Neo23x0/DLLRunner)
* [bohops/GhostBuild - a collection of simple MSBuild launchers for various GhostPack/.NET projects](https://github.com/bohops/GhostBuild)
* [outflanknl/NetshHelperBeacon - Example DLL to load from Windows NetShell - 没啥用](https://github.com/outflanknl/NetshHelperBeacon)
* [trustedsec/auto_SettingContent-ms - a quick POC for using the Matt Nelson (enigma0x3) technique for generating a malicious .SettingContent-ms extension type for remote code execution - 执行方法与HTA一致](https://github.com/trustedsec/auto_SettingContent-ms)
* [jpginc/xbapAppWhitelistBypassPOC - A POC application whitelisting XBAP project](https://github.com/jpginc/xbapAppWhitelistBypassPOC)

Bypass Applocker

* [shells.systems - AppLocker在NTFS扩展属性里缓存文件HASH，PSBits里的CopyEA工具可以将这个HASH修改成白名单里的值，并绕过AppLocker](https://shells.systems/post-bypassing-applocker-by-abusing-hashinfo/)
* [api0cradle/UltimateAppLockerByPassList - The goal of this repository is to document the most common techniques to bypass AppLocker](https://github.com/api0cradle/UltimateAppLockerByPassList)
* [freshness79/unlock - Microsoft Applocker evasion tool](https://github.com/freshness79/unlock)
* [cyberark/Evasor - an automated security assessment tool which locates existing executables on the Windows operating system that can be used to bypass any Application Control rules](https://github.com/cyberark/Evasor)

LOLBAS

* [api0cradle/LOLBAS - Living Off The Land Binaries And Scripts - (LOLBins and LOLScripts)](https://github.com/api0cradle/LOLBAS)
* [LOLBAS-Project/LOLBAS](https://github.com/LOLBAS-Project/LOLBAS)
* [Living Off The Land Binaries and Scripts (and also Libraries)](https://lolbas-project.github.io/)
* [CTI-Driven/LOLBins - The LOLBins CTI-Driven (Living-Off-the-Land Binaries Cyber Threat Intelligence Driven) is a project that aims to help cyber defenders understand how LOLBin binaries are used by threat actors during an intrusion in a graphical and digestible format for the TIPs platform using the STIX format](https://github.com/CTI-Driven/LOLBins)
* [marpie/signed-loaders - signed-loaders documents Windows executables that can be used for side-loading DLLs](https://github.com/marpie/signed-loaders)
* [bohops.com - Exploring the WDAC Microsoft Recommended Block Rules: VisualUiaVerifyNative - 很多有签名的 .NET 程序，会使用 BinaryFormatter 反序列化，可以用来执行任意操作](https://bohops.com/2020/10/15/exploring-the-wdac-microsoft-recommended-block-rules-visualuiaverifynative/)

Credential Guard

* [Adepts-Of-0xCC/SnoopyOwl](https://github.com/Adepts-Of-0xCC/SnoopyOwl)
  * [A physical graffiti of LSASS: getting credentials from physical memory for fun and learning](https://adepts.of0x.cc/physical-graffiti-lsass/)
* [teamhydra: Bypassing Credential Guard - 内存修改 lsass wdigest!g_IsCredGuardEnabled 和 wdigest!g_fParameter_useLogonCredential](https://teamhydra.blog/2020/08/25/bypassing-credential-guard/)
  * https://github.com/wh0nsq/BypassCredGuard
  * [PorLaCola25/TransactedSharpMiniDump - using NTFS transactions to avoid writting the minidump to disk and exfiltrating it via HTTPS using sockets](https://github.com/PorLaCola25/TransactedSharpMiniDump)
* [Do You Really Know About LSA Protection (RunAsPPL) - 主要参考PS_PROTECTED_SIGNER枚举，以及哪些程序可以打开PPL保护的进程](https://itm4n.github.io/lsass-runasppl/)

Lsass Dump

* https://github.com/gabriellandau/PPLFault
* [antonioCoco/MalSeclogon - A little tool to play with the Seclogon service - 利用泄露的handle实现lsass DUMP](https://github.com/antonioCoco/MalSeclogon)
* [Barbarisch/forkatz - credential dump using foreshaw technique using SeTrustedCredmanAccessPrivilege](https://github.com/Barbarisch/forkatz)
* [deepinstinct/LsassSilentProcessExit - Command line interface to dump LSASS memory to disk via SilentProcessExit - 调用RtlReportSilentProcessExit函数，使WerSvc服务立即为指定的PID生成MiniDump，比直接调用MiniDump更加隐蔽](https://github.com/deepinstinct/LsassSilentProcessExit)
* [anshaxing/Dumphash - 绕过杀软dumphash 离线读取](https://github.com/anshaxing/Dumphash)
* [jfmaes/SharpHandler - 使用已有的lsass handle来读取内存](https://github.com/jfmaes/SharpHandler)
* [b4rtik/SharpMiniDump - Create a minidump of the LSASS process from memory - pinvoke + syscall方式，更加隐蔽](https://github.com/b4rtik/SharpMiniDump)
* [CCob/MirrorDump - Another LSASS dumping tool that uses a dynamically compiled LSA plugin to grab an lsass handle and API hooking for capturing the dump in memory](https://github.com/CCob/MirrorDump)
* [gitjdm/dumper2020 - Yet another LSASS dumper](https://github.com/gitjdm/dumper2020)
* [ricardojoserf/TrickDump - Dump lsass using only NTAPIS running 3 programs to create 3 JSON and 1 ZIP file... and generate the Minidump later](https://github.com/ricardojoserf/TrickDump)
* [YOLOP0wn/POSTDump - POSTDump is the C# / .NET implementation of the ReactOS minidump function (like nanodump), thus avoiding call to the Windows API MiniDumpWriteDump function. The dump logic code is saved under the POSTMinidump project, feel free to use it for your own projects.](https://github.com/YOLOP0wn/POSTDump/)
* [outflanknl/Dumpert - LSASS memory dumper using direct system calls and API unhooking - 持续更新，而且有CS的组件](https://github.com/outflanknl/Dumpert)
* [FSecureLABS/physmem2profit - create a minidump of a target host's LSASS process by analysing physical memory remotely](https://github.com/FSecureLABS/physmem2profit)
* [Hackndo/lsassy - Extract credentials from lsass remotely - 通过wmi或者at远程执行命令，远程生成dump后直接解析并提取密码](https://github.com/Hackndo/lsassy)
* [cube0x0/MiniDump - C# Lsass parser - 参考pypykatz实现了minidump解析，以及部分lsass内存处理](https://github.com/cube0x0/MiniDump)
* [seventeenman/CallBackDump - 能过卡巴、核晶、defender等杀软的dump lsass进程工具](https://github.com/seventeenman/CallBackDump)
  * https://tttang.com/archive/1810/
* [peiga/DumpThatLSASS](https://github.com/peiga/DumpThatLSASS)
* [Iansus/SilentLsassDump - Dumping LSASS by Unhooking MiniDumpWriteDump by getting a fresh DbgHelp.dll copy from the disk , plus functions and strings obfuscation , it contains Anti-sandbox , if you run it under unperformant Virtual Machine you need to uncomment the code related to it and recompile](https://github.com/Iansus/SilentLsassDump)
* [hoangprod/AndrewSpecial - dumping lsass' memory stealthily and bypassing "Cilence" since 2019 - 恢复ReadVirtualMemory钩子，让MiniDumpWriteDump不被监控到，可以绕过EDR获取lsass的dump](https://github.com/hoangprod/AndrewSpecial)
* [OneSourceCat/creddump - creddump bypass AV - RPC触发lsass加载DLL](https://github.com/OneSourceCat/creddump)
* [b4rtik/ATPMiniDump - Evading WinDefender ATP credential-theft - 替换 MiniDumpWriteDump 为 PssCaptureSnapshot 即可](https://github.com/b4rtik/ATPMiniDump)
* [lengjibo/RedTeamTools/MiniDump - 使用COMSVCS!MiniDumpW创建，效果等同于dbghelp!MiniDumpWriteDump](https://github.com/lengjibo/RedTeamTools/blob/master/windows/MiniDump/CreateRemoteThreadTest/CreateRemoteThreadTest/CRTinjection.cpp)
* [GhostPack/SharpDump - a C# port of PowerSploit's Out-Minidump.ps1 functionality](https://github.com/GhostPack/SharpDump)

AMSI

* [ahkeur/VEH2 - A Patchless AMSI Bypass Technique using VEH](https://github.com/ahkeur/VEH2)
* [MzHmO/DebugAmsi - DebugAmsi is another way to bypass AMSI through the Windows process debugger mechanism](https://github.com/MzHmO/DebugAmsi)
* [waawaa/AMSI_Rubeus_bypass - AMSI bypass hooking NtCreateSection](https://github.com/waawaa/AMSI_Rubeus_bypass)
* [Flangvik/AMSI.fail - C# Azure Function with an HTTP trigger that generates obfuscated PowerShell snippets that break or disable AMSI for the current process](https://github.com/Flangvik/AMSI.fail)
* [gist: In-Process Patchless AMSI Bypass - 用断点方式，不用内存补丁，但是感觉很鸡肋](https://gist.github.com/CCob/fe3b63d80890fafeca982f76c8a3efdf)
* [gist: mattifestation/AMSIScriptContentRetrieval.ps1 - PoC code used to demonstrate extracting script contents using the AMSI ETW provider](https://gist.github.com/mattifestation/e179218d88b5f100b0edecdec453d9be)
* [countercept/AMSIDetection - AMSI detection PoC - 检测AMSI绕过的POC，对比硬盘上的amsi.dll与内存加载的版本section hash是否一致来实现的](https://github.com/countercept/AMSIDetection)
* [tokyoneon/Chimera - a (shiny and very hack-ish) PowerShell obfuscation script designed to bypass AMSI and commercial antivirus solutions](https://github.com/tokyoneon/Chimera)
* [didierstevens.com: New Tool: amsiscan.py](https://blog.didierstevens.com/2019/06/13/new-tool-amsiscan-py/)
* [spectorops: Antimalware Scan Interface Detection Optics Analysis Methodology: Identification and Analysis of AMSI for WMI - 通过amsi.dll关键词，枚举使用AMSI的EXE；通过ETW发现WinRM在产生 Microsoft-Antimalware-Scan-Interface 事件；逆向 JAmsiIsScannerNeeded 发现WMI有一套CRC白名单机制](https://posts.specterops.io/antimalware-scan-interface-detection-optics-analysis-methodology-858c37c38383)
* [RythmStick/AMSITrigger - The Hunt for Malicious Strings - pinvoke 调用 AmsiScanBuffer，定位特征码；他是按照4KB切割后，分段检测的，与实际检测结果不一定一致](https://github.com/RythmStick/AMSITrigger)
* [atxsinn3r/amsiscanner - A C/C++ implementation of Microsoft's Antimalware Scan Interface](https://github.com/atxsinn3r/amsiscanner)
* [cobbr/PSAmsi - a tool for auditing and defeating AMSI signatures](https://github.com/cobbr/PSAmsi)

Signature Identification

* [scrt/avdebugger - Most antivirus engines rely on strings or other bytes sequences, function exports and big integers to recognize malware. This project helps to automatically recover these signatures](https://github.com/scrt/avdebugger)
* [hegusung/AVSignSeek - Tool written in python3 to determine where the AV signature is located in a binary/payload](https://github.com/hegusung/AVSignSeek)
* [utds3lab/multiverse - A static binary rewriter that does not use heuristics](https://github.com/utds3lab/multiverse)
* [matterpreter/DefenderCheck - Identifies the bytes that Microsoft Defender flags on - 2K star，二分法调用Defender静态扫描、定位特征码](https://github.com/matterpreter/DefenderCheck)
  * https://github.com/gatariee/gocheck
* [rasta-mouse/ThreatCheck - Identifies the bytes that Microsoft Defender / AMSI Consumer flags on](https://github.com/rasta-mouse/ThreatCheck)

Linux

* [tokyoneon/Armor - Armor is a simple Bash script designed to create encrypted macOS payloads capable of evading antivirus scanners](https://github.com/tokyoneon/Armor)
* [Bashfuscator - A fully configurable and extendable Bash obfuscation framework](https://github.com/Bashfuscator/Bashfuscator)

Traffic Analysis Evasion

* [1tayH/noisy - A simple python script that generates random HTTP/DNS traffic noise in the background while you go about your regular web browsing, to make your web traffic data less valuable for selling and for extra obscurity](https://github.com/1tayH/noisy)
* [xpn/appproxyc2 - This repo contains a simple POC to show how to tunnel traffic through Azure Application Proxy](https://github.com/xpn/appproxyc2)
* [rvrsh3ll/FindFrontableDomains - Search for potential frontable domains - 查询alexa top 1000，看哪些CNAME指向了cloudfront、akamai、appspot等地址，这些是可以被利用的](https://github.com/rvrsh3ll/FindFrontableDomains)
* [redteam-cyberark/Google-Domain-fronting - Domain fronting using Google app engine](https://github.com/redteam-cyberark/Google-Domain-fronting)
* [vysec/DomainFrontingLists - A list of Domain Frontable Domains by CDN](https://github.com/vysec/DomainFrontingLists)
* [kirillwow/ids_bypass - IDS Bypass tricks](https://github.com/kirillwow/ids_bypass)
* [Evading Microsoft ATA - 2017年的很老了，需要重测，仅作为参考](http://www.labofapenetrationtester.com/2017/08/week-of-evading-microsoft-ata-day1.html)

Sandbox/cloud based detection evasion

* [violentlydave/mkhtaccess_red - Auto-generate an HTaccess for payload delivery -- automatically pulls ips/nets/etc from known sandbox companies/sources that have been seen before, and redirects them to a benign payload](https://github.com/violentlydave/mkhtaccess_red)
* [David-Reguera-Garcia-Dreg/anticuckoo - A tool to detect and crash Cuckoo Sandbox](https://github.com/David-Reguera-Garcia-Dreg/anticuckoo)
* [a0rtega/pafish - a demonstration tool that employs several techniques to detect sandboxes and analysis environments in the same way as malware families do](https://github.com/a0rtega/pafish)
* [LordNoteworthy/al-khaser - Public malware techniques used in the wild: Virtual Machine, Emulation, Debuggers, Sandbox detection](https://github.com/LordNoteworthy/al-khaser)
* [AlicanAkyol/sems - Virtualbox, VirtualMachine, Cuckoo, Anubis, ThreatExpert, Sandboxie, QEMU, Analysis Tools Detection Tools](https://github.com/AlicanAkyol/sems)
* [Arvanaghi/CheckPlease - Sandbox evasion modules written in PowerShell, Python, Go, Ruby, C, C#, Perl, and Rust](https://github.com/Arvanaghi/CheckPlease)
* [sharepub/CheckVM-Sandbox](https://github.com/sharepub/CheckVM-Sandbox)
* [fr0gger/RocProtect-V1 - Emulating Virtual Environment to stay protected against advanced malware](https://github.com/fr0gger/RocProtect-V1)
* [G4lB1t/SmoothCriminal - Detect sandbox by cursor movement speed - cuckoo的鼠标模拟是固定的，不够随机](https://github.com/G4lB1t/SmoothCriminal)
* [LloydLabs/wsb-detect - enables you to detect if you are running in Windows Sandbox ("WSB")](https://github.com/LloydLabs/wsb-detect)
* [ZanderChang/anti-sandbox - Windows对抗沙箱和虚拟机的方法总结](https://github.com/ZanderChang/anti-sandbox)
* 常见思路 - 如果读取注册表、检查沙箱、执行 ping 实现延迟、GetTickCount，会被杀软标记为可疑行为
  * 检查文件名长度是否为32或者包含`.md5.exe`
  * 桌面上的图标数量
  * 使用 GetForegroundWindow + Sleep 检查用户是否切换过窗口且数量大于3
  * 若 `py saz pcap chls` 之一存在文件关联，判断为沙箱环境
  * 使用 GetMonitorInfoA 检查分辨率是否高于 800x600（360有物理机无效）
  * 检查日期，只在周三启动
  * [Analyzing Azorult's Anti-Analysis Tricks with Joe Sandbox Hypervisor - 这个是规则检测](https://www.joesecurity.org/blog/9048980422564630717)
  * [从%WINDIR%\inf\setupapi.setup.log日志里获取BIOS等信息。使用WMI查询可能导致EDR报警](https://twitter.com/Arkbird_SOLG/status/1441876714246885381)

Steganography 隐写术

* [Und3rf10w/boblobblob - hiding git blobs in plain sight](https://github.com/Und3rf10w/boblobblob)
* [peewpw/Invoke-PSImage - Embeds a PowerShell script in the pixels of a PNG file and generates a oneliner to execute](https://github.com/peewpw/Invoke-PSImage)
* [DominicBreuker/stego-toolkit - Collection of steganography tools - helps with CTF challenges](https://github.com/DominicBreuker/stego-toolkit)
* [Under the hood: Hiding data in JPEG images](https://blog.nviso.eu/2020/07/13/how-to-embed-secret-data-in-jpeg-files/)

Uncategorized

* [Ghost Wolf Lab - Evasions](https://evasions.ghostwolflab.com/)
* [Tylous/ZipExec - A unique technique to execute binaries from a password protected zip](https://github.com/Tylous/ZipExec)
* [OsandaMalith/PE2HTML - Injects HTML/PHP/ASP to the PE](https://github.com/OsandaMalith/PE2HTML)
* [gh0stkey/avList - 杀软进程对应杀软名称 - 列表质量很差，还有一些病毒的名字，而且还区分大小写，有重复项目](https://github.com/gh0stkey/avList)
* [Allocated filter altitudes - 可用来做驱动黑名单](https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/allocated-altitudes)
* [Malware researchers - Beware of GetProcAddress spoofing via manipulation of PE format in memory - 就是修改IAT，小trick没啥用](https://dennisbabkin.com/blog/?t=malware-researchers-beware-of-getprocaddress-spoofing)

Resources

* https://evasions.checkpoint.com/
* [blackhat EU-21-Nisi-Lost-In-The-Loader - 不同版本的Windows，PE加载略有不同，可以利用这个特性绕过沙箱](https://i.blackhat.com/EU-21/Wednesday/EU-21-Nisi-Lost-In-The-Loader.pdf)
  * Win7 doesn’t accept executables with ImageBase = 0
  * Win7 and 10 check SizeOfHeaders under specific conditions, XP does not
  * Win7 and XP accept relocation types that 10 does not
  * Win7 and 10 discard binaries with entry point within the header
  * Win7 does not load binaries whose SizeOfImage is smaller than the offset of the last byte of the section table
* [xcon2016: 用深入解析AV虚拟机&高级Bypass技术](http://www.vxjump.net/files/seccon/BAVE_xcon2016.pdf)
* [Thread and Process State Change - Win10 20.04新增API NtCreateProcessStateChange](https://windows-internals.com/thread-and-process-state-change/)
* [Operators, EDR Sensors, and OODA Loops](https://web.archive.org/web/20230802194355/https://jackson_t.gitlab.io/ooda-loops.html)
* [Maelstrom: EDR Kernel Callbacks, Hooks, and Call Stacks](https://pre.empt.dev/posts/maelstrom-5/)
