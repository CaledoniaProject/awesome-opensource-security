# Windows library

Uncategorized

* [JustasMasiulis/inline_syscall - Header only library that allows you to generate direct syscall instructions in an optimized, inlineable and easy to use manner](https://github.com/JustasMasiulis/inline_syscall)
* [gtworek/PSBits - Simple (relatively) things allowing you to dig a bit deeper than usual - 高端工具代码，思路非常多](https://github.com/gtworek/PSBits)
* [zodiacon/WindowsInternals - Windows Internals Book 7th Edition Tools](https://github.com/zodiacon/WindowsInternals)
* [EyeOfRa/WinConMon - Windows Console Monitoring - 能够直接获取cmd.exe的输入输出](https://github.com/EyeOfRa/WinConMon)
* [Pavel's Blog: How can I close a handle in another process - 使用 NtQueryInformationProcess 获取所有 Handle，使用 DUPLICATE_CLOSE_SOURCE 参数复制 Handle，然后就实现了源的关闭](https://scorpiosoftware.net/2020/03/15/how-can-i-close-a-handle-in-another-process/)
* [itm4n/FullPowers - Recover the default privilege set of a LOCAL/NETWORK SERVICE account - 通过创建计划任务，恢复 local service 原有的特权](https://github.com/itm4n/FullPowers)
* [xtahi0nix/SetCriticalProcesses - Creating critical processes in Windows](https://github.com/xtahi0nix/SetCriticalProcesses)
* [DarthTon/Blackbone - Windows memory hacking library - 文档少，直接看例子](https://github.com/DarthTon/Blackbone)
* [arbiter34/GetProcAddress - Recreation of GetProcAddress without external dependencies on Windows Libraries](https://github.com/arbiter34/GetProcAddress)
* [microsoft/WindowsProtocolTestSuites - Windows Protocol Test Suites provide interoperability testing against an implementation of the Windows open specifications - 各种底层协议测试代码，应该会有用处](https://github.com/microsoft/WindowsProtocolTestSuites)
* [DoubleLabyrinth/SecurityDescriptorHelper - SecurityDescriptor Helper - 可以解读 D:P(A;;GA;;;SY) 这样的字符串](https://github.com/DoubleLabyrinth/SecurityDescriptorHelper)
* [DavidXanatos/wumgr - Windows update managemetn tool for windows 10](https://github.com/DavidXanatos/wumgr)
* [gist: w4kfu/95a87764db7029e03f09d78f7273c4f4 - SHIM 构建和注入，即使 compat 工具不支持；2016开始失效](https://gist.github.com/w4kfu/95a87764db7029e03f09d78f7273c4f4)
* [apriorit/SvcHostDemo - Demo service that runs in svchost.exe](https://github.com/apriorit/SvcHostDemo)
* [SinaKarvandi/Process-Magics - This is a collection of interesting codes about Windows Process creation - CriticalProcess/EnumHandles/ImpersonationPipeLine/...](https://github.com/SinaKarvandi/Process-Magics)
* [itm4n/CDPSvcDllHijacking - 代码的核心价值不是DLL劫持，而是token kidnapping: 遍历4~0xffff编号，尝试复制token，若成功则检查token是否可以利用](https://github.com/itm4n/CDPSvcDllHijacking)
* [blog: Quickpost: SelectMyParent or Playing With the Windows Process Tree - 指定父进程启动，可以降权也可以提权](https://blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/)
  * [decoder-it/psgetsystem - getsystem via parent process using ps1 & embeded c#](https://github.com/decoder-it/psgetsystem)
* [b4rtik/ATPMiniDump - Evading WinDefender ATP credential-theft - 替换 MiniDumpWriteDump 为 PssCaptureSnapshot 即可](https://github.com/b4rtik/ATPMiniDump)
* [outflanknl/Ps-Tools - an advanced process monitoring toolkit for offensive operations](https://github.com/outflanknl/Ps-Tools)
* [blog: Quickpost: Running a Service DLL - 如何使用svchost加载DLL服务](https://blog.didierstevens.com/2019/10/29/quickpost-running-a-service-dll/)
* [stackoverflow: NtCreateToken C++ 例子，未测试](https://stackoverflow.com/questions/47412590/create-a-user-token-from-sid-expand-environment-variables-in-user-context)
* [depletionmode/wsIPC - Working Set Page Cache side-channel IPC PoC](https://github.com/depletionmode/wsIPC)
* [zyantific/zydis - Fast and lightweight x86/x86-64 disassembler library - 持续更新，1.5K star](https://github.com/zyantific/zydis)
* [google/fruit - Fruit, a dependency injection framework for C++](https://github.com/google/fruit)
* [SekoiaLab/BinaryInjectionMitigation - analysis of the Microsoft binary injection mitigation - 查看进程安全策略，比如禁止加载第三方DLL等等](https://github.com/SekoiaLab/BinaryInjectionMitigation)
* [Antimalware Scan Interface Provider for Persistence](https://b4rtik.github.io/posts/antimalware-scan-interface-provider-for-persistence/)
  * [gist: b4rtik/AmsiProvider.cpp](https://gist.github.com/b4rtik/48ef702603d5e283bc81a05a01fccd40)

Lateral movement

* [ThunderGunExpress/DCOM_Work - modifies remote registry and when not properly understood could leave a system non-operational](https://github.com/ThunderGunExpress/DCOM_Work)
* [n0thing0x01/session_enum - 通过NetSessionEnum获取域内机器对应用户](https://github.com/n0thing0x01/session_enum)

Evasion

* [jthuraisamy/SysWhispers - AV/EDR evasion via direct system calls](https://github.com/jthuraisamy/SysWhispers)

Authentication

* [arcadejust/MultiotpCPV2RDP - Credential Provider V2 for Win8 and Win10 with RDP only option](https://github.com/arcadejust/MultiotpCPV2RDP)
* [jas502n/mimikat_ssp - 用RPC调用替代AddSecurityPackage函数，实现DLL加载](https://github.com/jas502n/mimikat_ssp)

Hardening

* [HoShiMin/Avanguard - The Win32 Anti-Intrusion Library - 主要是线程和钩子检查，看起很强](https://github.com/HoShiMin/Avanguard)
* [googleprojectzero: You Won't Believe what this One Line Change Did to the Chrome Sandbox - 加固思路可以参考，JobObject 限制子进程个数为1，Mitigation Policy 禁止子进程创建](https://googleprojectzero.blogspot.com/2020/04/you-wont-believe-what-this-one-line.html)
* [MalwareTech/AppContainerSandbox - An example sandbox using AppContainer (Windows 8+) - StartupInfo里传递安全属性，实现沙箱启动](https://github.com/MalwareTech/AppContainerSandbox)

File System

* [Real-time file monitoring on Windows with osquery - Windows 文件监控三种方案: ReadDirectoryChangesW 缓冲区大小固定，事件丢失多；内核驱动容易崩溃；NTFS journal 最可靠，osquery 就是这样做的](https://blog.trailofbits.com/2020/03/16/real-time-file-monitoring-on-windows-with-osquery/)
* [ultraembedded/fat_io_lib - Small footprint, low dependency, C code implementation of a FAT16 & FAT32 driver - FAT读写库，可以是基于文件的磁盘系统，ComRAT4在用](https://github.com/ultraembedded/fat_io_lib)
* [NtRaiseHardError/Anti-Delete - Protects deletion of files with a specified extension using a kernel-mode driver](https://github.com/NtRaiseHardError/Anti-Delete)

Registry

* [panagioto/SyscallHide - Create a Run registry key with direct system calls. Inspired by @Cneelis's Dumpert and SharpHide - 过不了sysmon](https://github.com/panagioto/SyscallHide)
* [3gstudent/HiddenNtRegistry - 以 `\0` 开头的注册表键值，无法用 Win32 API 打开，必须用 NT API](https://github.com/3gstudent/HiddenNtRegistry)

Desktop

* [vmcall/dxgkrnl_hook - C++ graphics kernel subsystem hook](https://github.com/vmcall/dxgkrnl_hook)
* [google/gumbo-parser - An HTML5 parsing library in pure C99 - 2016停更](https://github.com/google/gumbo-parser)

Anti debug

* [lurumdare/khaleesi - Anti-debug library](https://github.com/lurumdare/khaleesi)

Memory loading

* [fancycode/MemoryModule - 内存DLL加载，非常稳定 - MemoryLoadLibrary()/MemoryLoadLibraryEx()](https://github.com/fancycode/MemoryModule)
* [86hh/DreamLoader - Simple 32/64-bit PEs loader](https://github.com/86hh/DreamLoader)
* [zeroSteiner/reflective-polymorphism - provides various utilities for the self-modification of PE images](https://github.com/zeroSteiner/reflective-polymorphism)
* [rasta-mouse/TikiTorch - Process Hollowing via DotNetToJScript](https://github.com/rasta-mouse/TikiTorch)
* [kernelm0de/RunPE-ProcessHollowing - Process Hollowing is a technique mainly used by Malware Creators to hide malicious code behind Legitimate Process](https://github.com/kernelm0de/RunPE-ProcessHollowing)
* [m0n0ph1/Process-Hollowing - Great explanation of Process Hollowing](https://github.com/m0n0ph1/Process-Hollowing)
* [aaaddress1/RunPE-In-Memory - Run a 32bit copy of Exe File in memory (like what Software Packer Do)](https://github.com/aaaddress1/RunPE-In-Memory)
* [Zer0Mem0ry/RunPE - Code that allows running another windows PE in the same address space as the host process](https://github.com/Zer0Mem0ry/RunPE)
* [nettitude/SimplePELoader - A very simple PE loader for loading DLL's into memory without using LoadLibrary](https://github.com/nettitude/SimplePELoader)

UWP

* [zodiacon/RunAppContainer - Run executables in an AppContainer - 通过白名单权限方式，在UWP下面执行命令](https://github.com/zodiacon/RunAppContainer)

Printer

* [uri247/wdk81 - Print Monitors Samples](https://github.com/uri247/wdk81/tree/master/Print%20Monitors%20Samples/C%2B%2B/localmon)

Dropper

* [93aef0ce4dd141ece6f5/Packer - PoC executable packer using resources](https://github.com/93aef0ce4dd141ece6f5/Packer)

签名工具

* [trailofbits/uthenticode - A cross-platform library for verifying Authenticode signatures - WinVerifyTrust/CertVerifyCertificateChainPolicy 跨平台实现](https://github.com/trailofbits/uthenticode)
* [paranoidninja/CarbonCopy - A tool which creates a spoofed certificate of any online website and signs an Executable for AV Evasion - 用Web证书给PE签名是否合理？](https://github.com/paranoidninja/CarbonCopy)
* [mattifestation/PoCSubjectInterfacePackage - A proof-of-concept subject interface package (SIP) used to demonstrate digital signature subversion attacks - WINTRUST PE 签名校验的样例](https://github.com/mattifestation/PoCSubjectInterfacePackage)
  * [SpectorOps: Subverting Trust in Windows](https://www.specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf)

Cheat

* [niemand-sec/AntiCheat-Testing-Framework - Framework to test any Anti-Cheat](https://github.com/niemand-sec/AntiCheat-Testing-Framework)



